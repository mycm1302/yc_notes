# 오일러각

> 상위: [[회전표현]]
> 
> 레퍼런스:
> - **Modern Robotics** - Lynch & Park (2017) - Chapter 3.2.3
> - **Robotics Unveiled - Euler Angles ZYX and Roll-Pitch-Yaw** (2024년 4월)
> - **Mecharithm - Explicit Representations for Orientation: Euler Angles** (2025년)
> - **Wikipedia - Gimbal Lock** (2025년 3월)

세 개의 각도로 3차원 회전을 명시적으로 표현하는 직관적인 방법입니다.

## 🔄 기본 정의

### 개념
오일러각은 3차원 회전을 세 개의 순차적인 회전의 조합으로 분해한 표현법입니다:
- **최소 매개변수**: 정확히 3개의 각도로 3자유도 회전 표현
- **명시적 표현**: 각 각도의 물리적 의미가 명확
- **순서 의존**: 회전 순서에 따라 결과가 달라짐

### 수학적 표현
일반적인 오일러각 변환:
```
R(α,β,γ) = R_axis1(α) × R_axis2(β) × R_axis3(γ)
```

여기서 각 축은 좌표축(x, y, z) 중 하나이며, 회전 순서에 따라 결과가 결정됩니다.

---

## 📐 주요 규약 (Conventions)

### 1. ZYX 오일러각 (Roll-Pitch-Yaw)
가장 널리 사용되는 규약으로, 항공우주 분야에서 표준입니다:

```
R_ZYX(ψ,θ,φ) = R_z(ψ) × R_y(θ) × R_x(φ)
```

- **ψ (Yaw)**: Z축 회전 (방위각)
- **θ (Pitch)**: Y축 회전 (피치각) 
- **φ (Roll)**: X축 회전 (롤각)

### 행렬 형태
```
R_ZYX = [cos ψ cos θ   cos ψ sin θ sin φ - sin ψ cos φ   cos ψ sin θ cos φ + sin ψ sin φ]
        [sin ψ cos θ   sin ψ sin θ sin φ + cos ψ cos φ   sin ψ sin θ cos φ - cos ψ sin φ]
        [-sin θ        cos θ sin φ                       cos θ cos φ                      ]
```

### 2. ZYZ 오일러각 (Proper Euler Angles)
고전적인 오일러각으로, 동일한 축(Z)이 처음과 마지막에 사용됩니다:

```
R_ZYZ(α,β,γ) = R_z(α) × R_y(β) × R_z(γ)
```

### 3. 기타 규약들
- **XYZ**: 순차적으로 X, Y, Z축 회전
- **XYX, YZY, XZX**: 동일 축이 처음과 마지막에 오는 proper 오일러각
- **YXZ, ZXY**: 다양한 순서의 Tait-Bryan 각

---

## ⚠️ 짐벌락 (Gimbal Lock)

### 발생 조건
ZYX 규약에서 **θ = ±90°** 일 때 발생:
```
When θ = ±π/2:
- 첫 번째 회전축(Z)과 세 번째 회전축(X)이 평행해짐
- 하나의 자유도 상실
- ψ와 φ의 조합만으로 회전 결정
```

### 수학적 특이점
짐벌락 시 역변환이 불가능해집니다:
```
For θ = 90°:
r₁₃ = cos ψ sin φ + sin ψ cos φ = sin(ψ + φ)
r₂₃ = sin ψ sin φ - cos ψ cos φ = -cos(ψ + φ)

→ ψ + φ만 결정 가능, 개별 값은 무한개
```

### 물리적 의미
- **실제 로봇**: 특정 자세에서 운동성 제약
- **제어 시스템**: 불안정한 제어 응답
- **궤적 계획**: 부드러운 경로 계획 어려움

---

## 🔄 역변환 (Matrix to Angles)

### ZYX 규약의 역변환
회전행렬 R에서 오일러각 추출:

```
일반적인 경우 (cos θ ≠ 0):
θ = atan2(-r₃₁, √(r₃₂² + r₃₃²))
ψ = atan2(r₂₁, r₁₁)  
φ = atan2(r₃₂, r₃₃)

특이점 (θ = ±90°):
θ = ±π/2로 고정
ψ - φ = atan2(r₁₂, r₂₂) (θ = π/2)
ψ + φ = atan2(r₁₂, r₂₂) (θ = -π/2)
```

### atan2 함수 활용
- **atan2(y, x)**: 4사분면을 모두 고려한 역탄젠트
- **범위**: (-π, π]
- **특이점 회피**: 분모가 0인 경우 자동 처리

---

## 💡 장단점 분석

### 장점
- **직관적**: 물리적 의미가 명확 (yaw, pitch, roll)
- **최소 표현**: 정확히 3개 매개변수
- **효율적**: 메모리 사용량 최소
- **사용자 친화적**: UI에서 입력/출력이 용이

### 단점
- **짐벌락**: 특정 자세에서 특이점 발생
- **순서 의존**: 회전 순서에 따라 결과 상이
- **불연속성**: 2π 경계에서 불연속
- **보간 어려움**: 선형 보간 시 비현실적 경로

---

## 🎯 로봇공학 응용

### 적용 분야
- **드론/항공기**: Roll-Pitch-Yaw 제어
- **로봇 말단**: 엔드이펙터 자세 지정
- **카메라 시스템**: Pan-Tilt-Roll 제어
- **사용자 인터페이스**: 직관적 자세 입력

### 실무 고려사항

#### 1. 짐벌락 회피 전략
- **작업공간 제한**: 특이점 근처 회피
- **다중 해법**: 여러 경로 중 최적 선택
- **하이브리드 접근**: 사원수와 조합 사용

#### 2. 수치적 안정성
```python
# 안전한 역변환 예시
def safe_atan2(y, x, threshold=1e-6):
    if abs(x) < threshold and abs(y) < threshold:
        return 0.0  # 특이점 처리
    return atan2(y, x)
```

#### 3. 각도 정규화
```python
def normalize_angle(angle):
    """각도를 [-π, π] 범위로 정규화"""
    return ((angle + π) % (2*π)) - π
```

---

## 🔗 다른 표현과의 비교

### vs 회전행렬
- **오일러각**: 3개 매개변수, 특이점 존재
- **회전행렬**: 9개 매개변수, 특이점 없음

### vs 사원수
- **오일러각**: 직관적, 짐벌락 발생
- **사원수**: 특이점 없음, 직관성 부족

### vs 축각표현
- **오일러각**: 순차 회전, 물리적 의미 명확
- **축각표현**: 단일 회전, 최적 경로

---

## 🛠️ 구현 예제

### ZYX 순변환
```python
def euler_to_matrix(yaw, pitch, roll):
    """ZYX 오일러각을 회전행렬로 변환"""
    R_z = rotation_z(yaw)
    R_y = rotation_y(pitch) 
    R_x = rotation_x(roll)
    return R_z @ R_y @ R_x
```

### ZYX 역변환
```python
def matrix_to_euler(R):
    """회전행렬을 ZYX 오일러각으로 변환"""
    pitch = atan2(-R[2,0], sqrt(R[2,1]**2 + R[2,2]**2))
    
    if abs(cos(pitch)) > 1e-6:  # 일반적인 경우
        yaw = atan2(R[1,0], R[0,0])
        roll = atan2(R[2,1], R[2,2])
    else:  # 짐벌락
        yaw = atan2(-R[0,1], R[1,1])
        roll = 0.0  # 임의로 설정
        
    return yaw, pitch, roll
```

---

## 🔗 연결 분야
- 상위: [[회전표현]]
- 기초: [[기본개념]], [[회전행렬]]
- 대안: [[사원수]], [[축각표현]]
- 응용: [[순기구학]], [[로봇제어기법]]

---

## 📚 참고문헌
1. Lynch, K.M. & Park, F.C. (2017). *Modern Robotics: Mechanics, Planning, and Control*. Cambridge University Press. Chapter 3.2.3
2. Robotics Unveiled. (2024). "Representations of Orientation: Euler Angles - ZYX and Roll-Pitch-Yaw." Retrieved April 2024
3. Mecharithm. (2025). "Explicit Representations for the Orientation: Euler Angles." Educational Content
4. Wikipedia Contributors. (2025). "Gimbal lock." *Wikipedia*. Retrieved March 2025
5. Wang, Y. (2020). "Gimbal Lock." Personal Blog. Retrieved April 2020