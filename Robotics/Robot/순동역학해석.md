# 순동역학해석

> 상위: [[운동해석]]

주어진 힘과 토크에 의한 시스템의 운동 응답을 계산하는 동역학 해석 방법입니다.

## 📐 기본 개념

### 정의
순동역학해석(Forward Dynamics Analysis)은 주어진 조인트 토크나 외력이 작용할 때, 시스템이 보이는 운동 응답(가속도, 속도, 위치)을 계산하는 과정입니다 [1].

### 수학적 표현
```
q̈ = M⁻¹(q)[τ - C(q,q̇)q̇ - G(q) - F(q̇)]
```
여기서:
- q̈: 조인트 가속도 벡터
- M⁻¹(q): 관성 행렬의 역행렬
- τ: 입력 토크 벡터

## 🔄 해석 방법

### 1. 직접 방법 (Direct Method)
관성 행렬을 직접 계산하고 역행렬을 구하는 방법입니다 [2].

**절차:**
1. 관성 행렬 M(q) 계산
2. 코리올리/원심력 C(q,q̇) 계산
3. 중력항 G(q) 계산
4. 가속도 q̈ = M⁻¹[τ - C - G] 계산

**단점:**
- O(n³) 계산 복잡도 (역행렬 계산)
- 수치적 불안정성 가능
### 2. Articulated Body Algorithm (ABA)
Featherstone이 개발한 O(n) 복잡도의 효율적 알고리즘입니다 [3].

**핵심 개념:**

**1. Articulated Body Inertia (ABI):**
특정 조인트에서 바라본 outboard body들의 등가 관성:
```
Iᴬᵢ = Iᵢ + Σⱼ∈outboard(i) [Iᴬⱼ - sⱼsⱼᵀIᴬⱼ/sⱼᵀIᴬⱼsⱼ]
```

여기서:
- Iᴬᵢ: 링크 i의 articulated body inertia
- sⱼ: 조인트 j의 운동 축
- Iᵢ: 링크 i의 공간 관성 행렬

**2. Bias Force:**
코리올리, 원심력, 중력 등의 합성력:
```
pᴬᵢ = pᵢ + Σⱼ∈outboard(i) [pᴬⱼ - sⱼτⱼ/sⱼᵀIᴬⱼsⱼ + sⱼsⱼᵀpᴬⱼ/sⱼᵀIᴬⱼsⱼ]
```

**알고리즘 절차:**

**Phase 1: Outward Pass (Base → Tip)**
각 링크에 대해 순차적으로:

1. **Velocity Propagation:**
```
vᵢ = Xᵢvᵢ₋₁ + sᵢq̇ᵢ
```

2. **Bias Acceleration:**
```
cᵢ = sᵢq̈ᵢ + cJᵢ + vᵢ × vᵢ
```

여기서 cJᵢ는 조인트의 bias acceleration

3. **Articulated Body Inertia:**
자식 링크들의 기여도 누적

4. **Bias Force Calculation:**
중력, 외력, 코리올리력 누적

**Phase 2: Inward Pass (Tip → Base)**
조인트 가속도 계산:

```
q̈ᵢ = (τᵢ - sᵢᵀpᴬᵢ)/(sᵢᵀIᴬᵢsᵢ)
```

**Phase 3: Outward Pass (Base → Tip)**
링크 가속도 전파:

```
aᵢ = Xᵢaᵢ₋₁ + sᵢq̈ᵢ + cᵢ
```

**공간 벡터 표기법:**
6차원 벡터를 사용하여 선형 및 각운동을 통합 표현:
```
v = [ω]  (공간 속도)
    [v]

a = [α]  (공간 가속도)  
    [a]

f = [n]  (공간 힘)
    [f]
```

**변환 행렬 (Plücker Transform):**
```
X = [R   0  ]
    [p×R R  ]
```

여기서 p×는 벡터 p의 skew-symmetric 행렬

**장점:**
- 선형 계산 복잡도 O(n)
- 수치적 안정성 우수
- 복잡한 체인 구조에 효과적
- 병렬 처리 가능
- 접촉력 처리 용이

### 3. Composite Rigid Body Algorithm (CRBA)
관성 행렬을 효율적으로 계산하는 O(n²) 알고리즘입니다 [4].

**적용:**
- 관성 행렬이 자주 변하지 않는 경우
- 여러 시뮬레이션 케이스에 동일 구조 사용
- 실시간성이 중요하지 않은 해석

## 🎯 응용 분야

### 시뮬레이션
- **동작 시뮬레이션**: 로봇의 자연스러운 운동 예측
- **충돌 해석**: 외부 충격에 대한 응답 분석
- **진동 해석**: 시스템의 동적 특성 연구

### 제어 시스템 설계
- **시스템 모델링**: 제어기 설계를 위한 플랜트 모델
- **시뮬레이션 기반 제어**: 모델 예측 제어 (MPC)
- **강건성 분석**: 불확실성에 대한 성능 평가

### 최적화 설계
- **동적 성능 평가**: 설계 대안의 동적 특성 비교
- **공진 회피**: 위험 주파수 대역 식별
- **에너지 효율성**: 동적 특성을 고려한 효율적 설계

## 🔍 수치 적분 방법

### 명시적 방법 (Explicit Methods)
**Runge-Kutta 방법:**
- 4차 RK: 정확도와 안정성의 균형
- 적응적 스텝 크기: 오차 제어
- 강체 시스템에 적합

### 암시적 방법 (Implicit Methods)
**후진 오일러 방법:**
- 수치적 안정성 우수
- 큰 시간 스텝 가능
- Stiff 시스템에 적합

### 접촉 및 충돌 처리
- **이벤트 감지**: 접촉 시점의 정확한 탐지
- **충격량 계산**: 순간적 속도 변화 처리
- **페널티 방법**: 연속적 접촉력 모델링 [5]

## 📊 성능 최적화

### 계산 효율성
- **자료구조 최적화**: 희소 행렬 활용
- **병렬 처리**: 독립적 계산의 병렬화
- **캐싱**: 반복 계산 결과 저장

### 수치적 안정성
- **조건수 모니터링**: 행렬의 수치적 상태 확인
- **정규화**: 스케일링을 통한 오차 감소
- **오차 제어**: 적응적 알고리즘 적용

## 📚 참고문헌

[1] Craig, J.J. (2017). *Introduction to Robotics: Mechanics and Control*. 4th Edition, Pearson. ISBN: 978-0133489798.
- Chapter 6: Manipulator Dynamics, pp. 211-268
- Section 6.7: Forward Dynamics, pp. 256-268

[2] Featherstone, R. (2008). *Rigid Body Dynamics Algorithms*. Springer. ISBN: 978-0387743141.
- Chapter 7: The Articulated-Body Algorithm, pp. 141-188
- Chapter 4: Spatial Rigid-Body Dynamics, pp. 85-108

[3] Spong, M.W., Hutchinson, S., & Vidyasagar, M. (2020). *Robot Modeling and Control*. 2nd Edition, Wiley. ISBN: 978-1118524305.
- Chapter 6: Dynamics, pp. 203-268
- Section 6.5: Forward Dynamics, pp. 245-258

[4] Walker, M.W., & Orin, D.E. (1982). "Efficient Dynamic Computer Simulation of Robotic Mechanisms". *ASME Journal of Dynamic Systems, Measurement, and Control*, 104(3), 205-211.
- 원저: Composite Rigid Body Algorithm (CRBA)

[5] Featherstone, R. (1983). "The Calculation of Robot Dynamics Using Articulated-Body Inertias". *The International Journal of Robotics Research*, 2(1), 13-30.
- 원저: Articulated Body Algorithm (ABA)

[6] Siciliano, B., et al. (2010). *Robotics: Modelling, Planning and Control*. Springer. ISBN: 978-1846286414.
- Chapter 7: Dynamics, pp. 269-330
- Section 7.3: Forward dynamics problem, pp. 295-308

[7] Lynch, K.M., & Park, F.C. (2017). *Modern Robotics*. Cambridge University Press. ISBN: 978-1107156302.
- Chapter 8: Dynamics of Open Chains, pp. 267-318
- Section 8.6: Forward Dynamics, pp. 308-318

[8] Shabana, A.A. (2020). *Dynamics of Multibody Systems*. 5th Edition, Cambridge University Press. ISBN: 978-1107042650.
- Chapter 8: Constrained Multibody Systems, pp. 318-375
- Contact dynamics and numerical integration methods

[9] Gilardi, G., & Sharf, I. (2002). "Literature Survey of Contact Dynamics Modelling". *Mechanism and Machine Theory*, 37(10), 1213-1239.
- 접촉 동역학 모델링에 대한 종합적 리뷰

---

## 🔗 연결 분야
- **상위**: [[운동해석]]
- **관련**: [[역동역학해석]], [[가속도해석]]
- **도구**: [[ADAMS]], [[RecurDyn]], [[SimMechanics]]

## 태그
#순동역학 #ABA #CRBA #시뮬레이션 #수치적분