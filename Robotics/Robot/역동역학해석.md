# 역동역학해석

> 상위: [[운동해석]]

주어진 운동에 필요한 힘과 토크를 계산하는 동역학 해석 방법입니다.

## 📐 기본 개념

### 정의
역동역학해석(Inverse Dynamics Analysis)은 원하는 운동(위치, 속도, 가속도)이 주어졌을 때, 이를 실현하기 위해 필요한 조인트 토크나 구동력을 계산하는 과정입니다 [1].

### 수학적 표현
```
τ = M(q)q̈ + C(q,q̇)q̇ + G(q) + F(q̇)
```
여기서:
- τ: 조인트 토크 벡터
- M(q): 관성 행렬
- C(q,q̇): 코리올리 및 원심력 행렬  
- G(q): 중력 벡터
- F(q̇): 마찰력 벡터

## 🔄 해석 방법

### 1. 뉴턴-오일러 방법 (Newton-Euler Method)
각 링크에 대해 뉴턴-오일러 방정식을 순차적으로 적용하는 방법입니다 [2].

**뉴턴 방정식 (병진 운동):**
```
fᵢ = mᵢaᶜᵢ
```

**오일러 방정식 (회전 운동):**
```
τᵢ = Iᵢαᵢ + ωᵢ × (Iᵢωᵢ)
```

여기서:
- fᵢ: 링크 i에 작용하는 합력
- mᵢ: 링크 i의 질량
- aᶜᵢ: 무게중심의 가속도
- τᵢ: 링크 i에 작용하는 합 토크
- Iᵢ: 관성 텐서
- αᵢ: 각가속도
- ωᵢ: 각속도

**전진 재귀 (Forward Recursion):**
베이스에서 말단으로 운동학적 정보 전파:

1. **각속도 전파:**
```
ᵢωᵢ = ᵢ⁻¹Rᵢ · ᵢ⁻¹ωᵢ₋₁ + q̇ᵢzᵢ
```

2. **각가속도 전파:**
```
ᵢαᵢ = ᵢ⁻¹Rᵢ · ᵢ⁻¹αᵢ₋₁ + ᵢ⁻¹Rᵢ(ᵢ⁻¹ωᵢ₋₁ × q̇ᵢzᵢ) + q̈ᵢzᵢ
```

3. **선가속도 전파:**
```
ᵢaᵢ = ᵢ⁻¹Rᵢ[ᵢ⁻¹αᵢ₋₁ × ᵢ⁻¹pᵢ + ᵢ⁻¹ωᵢ₋₁ × (ᵢ⁻¹ωᵢ₋₁ × ᵢ⁻¹pᵢ) + ᵢ⁻¹aᵢ₋₁]
```

4. **무게중심 가속도:**
```
ᵢaᶜᵢ = ᵢαᵢ × ᵢpᶜᵢ + ᵢωᵢ × (ᵢωᵢ × ᵢpᶜᵢ) + ᵢaᵢ
```

**후진 재귀 (Backward Recursion):**
말단에서 베이스로 힘과 토크 전파:

1. **관성력 계산:**
```
ᵢFᵢ = mᵢᵢaᶜᵢ
ᵢNᵢ = ᵢIᵢᵢαᵢ + ᵢωᵢ × (ᵢIᵢᵢωᵢ)
```

2. **힘 전파:**
```
ᵢfᵢ = ᵢ⁺¹Rᵢ₊₁ · ᵢ⁺¹fᵢ₊₁ + ᵢFᵢ
```

3. **토크 전파:**
```
ᵢnᵢ = ᵢNᵢ + ᵢ⁺¹Rᵢ₊₁ · ᵢ⁺¹nᵢ₊₁ + ᵢpᶜᵢ × ᵢFᵢ + ᵢpᵢ₊₁ × (ᵢ⁺¹Rᵢ₊₁ · ᵢ⁺¹fᵢ₊₁)
```

4. **조인트 토크:**
```
τᵢ = ᵢnᵢᵀ · zᵢ (회전 조인트)
τᵢ = ᵢfᵢᵀ · zᵢ (직동 조인트)
```
**장점:**
- 계산 효율성 (O(n) 복잡도)
- 물리적 직관성
- 실시간 제어에 적합

### 2. 라그랑지안 방법 (Lagrangian Method)
에너지 관점에서 동역학 방정식을 유도하는 방법입니다 [3].

**라그랑지안 정의:**
라그랑지안 L은 시스템의 운동에너지에서 위치에너지를 뺀 값으로 정의됩니다:
```
L(q, q̇) = T(q, q̇) - V(q)
```

여기서:
- T(q, q̇): 전체 운동에너지 (조인트 위치와 속도에 의존)
- V(q): 전체 위치에너지 (조인트 위치에만 의존)
- q: 일반좌표 벡터 (조인트 변수들)
- q̇: 일반속도 벡터 (조인트 속도들)

**운동에너지 계산:**
n-링크 매니퓰레이터의 전체 운동에너지는:
```
T = (1/2)∑ᵢ₌₁ⁿ [mᵢvᶜᵢᵀvᶜᵢ + ωᵢᵀIᵢωᵢ]
```

여기서:
- mᵢ: 링크 i의 질량
- vᶜᵢ: 링크 i의 무게중심 속도
- ωᵢ: 링크 i의 각속도
- Iᵢ: 링크 i의 관성 텐서

이를 조인트 속도로 표현하면:
```
T = (1/2)q̇ᵀM(q)q̇
```

여기서 M(q)는 관성 행렬입니다.

**위치에너지 계산:**
중력에 의한 위치에너지는:
```
V = ∑ᵢ₌₁ⁿ mᵢgᵀpᶜᵢ(q)
```

여기서:
- g: 중력 벡터 [0, 0, -9.81]ᵀ
- pᶜᵢ(q): 링크 i의 무게중심 위치 벡터

**오일러-라그랑지 방정식:**
각 조인트 j에 대해:
```
d/dt(∂L/∂q̇ⱼ) - ∂L/∂qⱼ = τⱼ
```

이를 벡터 형태로 표현하면:
```
d/dt(∂L/∂q̇) - ∂L/∂q = τ
```

**미분 계산:**
- **관성항**: ∂L/∂q̇ⱼ = ∂T/∂q̇ⱼ = ∑ₖ Mⱼₖq̇ₖ
- **관성항의 시간미분**: d/dt(∂L/∂q̇ⱼ) = ∑ₖ Ṁⱼₖq̇ₖ + ∑ₖ Mⱼₖq̈ₖ
- **구성항**: ∂L/∂qⱼ = ∂T/∂qⱼ - ∂V/∂qⱼ

**최종 동역학 방정식:**
```
M(q)q̈ + C(q,q̇)q̇ + G(q) = τ
```

여기서:
- M(q): 관성 행렬
- C(q,q̇): 코리올리 및 원심력 행렬
- G(q): 중력 벡터 = ∂V/∂q

**장점:**
- 물리적 직관성: 에너지 관점에서 접근
- 체계적 유도: 스칼라 함수(에너지)로부터 방정식 도출
- 제약력 제거: 구속조건에 의한 내력이 자동으로 제거됨
- 일반좌표 사용: 임의의 좌표계에서 적용 가능

### 3. 가상일의 원리 (Virtual Work Principle)
가상 변위에 대한 일의 평형을 이용한 동역학 방정식 유도 방법입니다 [4].

**기본 원리:**
시스템이 동적 평형상태에 있을 때, 모든 가상 변위에 대한 가상일의 총합이 0이 됩니다:
```
δW = δWₐₚₚₗᵢₑ𝒹 + δWᵢₙₑᵣₜᵢₐₗ = 0
```

**가상 변위 (Virtual Displacement):**
- 시간을 고정하고 시스템에 가해지는 임의의 무한소 변위
- 모든 기하학적 구속조건을 만족해야 함
- 실제 운동과는 무관한 가상적 변위

조인트 공간에서의 가상 변위: δq = [δq₁, δq₂, ..., δqₙ]ᵀ

**다랑베르의 원리 (D'Alembert's Principle):**
관성력을 가상력으로 도입하여 동역학 문제를 정역학 문제로 변환:
```
δW = ∑ⁿᵢ₌₁ (Fᵢ - mᵢaᵢ)ᵀδrᵢ + ∑ⁿᵢ₌₁ (Mᵢ - Iᵢαᵢ)ᵀδθᵢ = 0
```

여기서:
- Fᵢ, Mᵢ: 링크 i에 작용하는 외력과 외부 모멘트
- mᵢaᵢ, Iᵢαᵢ: 관성력과 관성 모멘트
- δrᵢ, δθᵢ: 링크 i의 가상 선변위와 각변위

**조인트 공간으로의 변환:**
작업공간의 가상 변위를 조인트 공간으로 변환:
```
δrᵢ = Jᵛᵢ(q)δq  (선속도 자코비안)
δθᵢ = Jᵂᵢ(q)δq  (각속도 자코비안)
```

**가상일 방정식:**
```
δW = ∑ⁿᵢ₌₁ [(Fᵢ - mᵢaᵢ)ᵀJᵛᵢ + (Mᵢ - Iᵢαᵢ)ᵀJᵂᵢ]δq = 0
```

δq는 임의의 가상 변위이므로, 각 계수가 0이 되어야 함:
```
∑ⁿᵢ₌₁ [(Fᵢ - mᵢaᵢ)ᵀJᵛᵢ + (Mᵢ - Iᵢαᵢ)ᵀJᵂᵢ] = 0
```

**일반화된 힘 (Generalized Forces):**
- **외부 일반화 힘**: Qₑₓₜ = ∑ⁿᵢ₌₁ [FᵢᵀJᵛᵢ + MᵢᵀJᵂᵢ]
- **관성 일반화 힘**: Qᵢₙₑᵣₜᵢₐₗ = ∑ⁿᵢ₌₁ [mᵢaᵢᵀJᵛᵢ + (Iᵢαᵢ)ᵀJᵂᵢ]

**최종 동역학 방정식:**
```
Qₑₓₜ - Qᵢₙₑᵣₜᵢₐₗ = τ
```

**로봇공학에서의 적용:**
1. **조인트 토크 계산**: τⱼ = ∑ⁿᵢ₌₁ [Fᵢᵀ∂rᵢ/∂qⱼ + Mᵢᵀ∂θᵢ/∂qⱼ]
2. **구속력 제거**: 내부 구속력은 가상일에 기여하지 않음
3. **병렬 로봇**: 폐루프 구조에서 특히 유용

**장점:**
- 구속력 자동 제거: 내부 구속력을 고려할 필요 없음
- 직관적 접근: 힘과 일의 개념으로 이해 용이
- 복잡한 구조: 폐루프나 다체계 시스템에 효과적
- 수치적 안정성: 라그랑지안보다 계산상 유리한 경우

**가상일 원리의 구현 절차:**
1. 시스템의 자유도 결정
2. 가상 변위 정의 (구속조건 만족)
3. 각 링크의 가상일 계산
4. 전체 가상일의 합 = 0 조건 적용
5. 조인트 토크에 대한 방정식 도출

## 🎯 응용 분야

### 로봇 제어
- **피드포워드 제어**: 중력 보상 및 동역학 보상
- **계산 토크 제어**: 비선형성 완전 보상
- **적응 제어**: 매개변수 추정과 함께 사용

### 궤적 계획
- **최적 궤적**: 에너지 최소화 궤적 설계
- **토크 제한**: 액추에이터 한계 고려
- **부드러운 운동**: 가속도 제한을 통한 진동 감소

### 설계 최적화
- **액추에이터 선정**: 필요 토크 사양 결정
- **기구 최적화**: 동역학 성능 개선을 위한 설계
- **에너지 효율성**: 소비 전력 최소화

## 🔍 효율적 계산 기법

### 재귀 알고리즘
**Featherstone의 Articulated Body Algorithm:**
- O(n) 복잡도 달성
- 공간 벡터 대수 활용
- 복잡한 체인 구조에 효과적 [5]

### 병렬 계산
- **분산 처리**: 독립적 계산 부분의 병렬화
- **GPU 활용**: 행렬 연산의 고속 처리
- **실시간 구현**: 제어 주기 내 계산 완료

## 📊 수치적 고려사항

### 정확도와 안정성
- **수치적 미분**: 가속도 계산 시 노이즈 증폭
- **특이점 처리**: 자코비안 특이점 근처의 안정성
- **반올림 오차**: 연쇄 계산에 따른 오차 누적

### 실시간 구현
- **계산 복잡도**: 알고리즘 선택과 최적화
- **메모리 사용**: 중간 계산 결과의 효율적 저장
- **병목 지점**: 성능 제한 요소 분석

## 📚 참고문헌

[1] Craig, J.J. (2017). *Introduction to Robotics: Mechanics and Control*. 4th Edition, Pearson. ISBN: 978-0133489798.
- Chapter 6: Manipulator Dynamics, pp. 211-268
- Section 6.4-6.6: Newton-Euler and Lagrangian formulations

[2] Featherstone, R. (2008). *Rigid Body Dynamics Algorithms*. Springer. ISBN: 978-0387743141.
- Chapter 5: The Recursive Newton-Euler Algorithm, pp. 109-140
- Chapter 9: Efficient Algorithms, pp. 189-226

[3] Lynch, K.M., & Park, F.C. (2017). *Modern Robotics: Mechanics, Planning, and Control*. Cambridge University Press. ISBN: 978-1107156302.
- Chapter 8: Dynamics of Open Chains, pp. 267-318
- Section 8.1: Lagrangian Formulation of Dynamics
- URL: https://modernrobotics.northwestern.edu/nu-gm-book-resource/chapter-8-1-lagrangian-formulation-of-dynamics-part-1-of-2/

[4] Scaron, S. (2024). "Principle of Virtual Work in Robotics". 
- URL: https://scaron.info/robotics/principle-of-virtual-work.html
- Comprehensive treatment of virtual work principle for constrained robotic systems

[5] Spong, M.W., Hutchinson, S., & Vidyasagar, M. (2020). *Robot Modeling and Control*. 2nd Edition, Wiley. ISBN: 978-1118524305.
- Chapter 6: Dynamics, pp. 203-268
- Section 6.2: Inverse Dynamics, pp. 230-245

[6] Siciliano, B., et al. (2010). *Robotics: Modelling, Planning and Control*. Springer. ISBN: 978-1846286414.
- Chapter 7: Dynamics, pp. 269-330
- Section 7.2: Newton-Euler formulation, pp. 278-295

[7] Angeles, J. (2014). *Fundamentals of Robotic Mechanical Systems*. 4th Edition, Springer. ISBN: 978-3319018508.
- Chapter 6: Dynamics of Robotic Mechanical Systems, pp. 251-302
- Section 6.3: Inverse dynamics, pp. 275-288

[8] Paul, R.P. (1981). *Robot Manipulators: Mathematics, Programming, and Control*. MIT Press. ISBN: 978-0262161329.
- Chapter 6: Dynamics, pp. 145-178
- Original recursive Newton-Euler formulation

[9] Luh, J.Y.S., Walker, M.W., & Paul, R.P. (1980). "On-Line Computational Scheme for Mechanical Manipulators". *ASME Journal of Dynamic Systems, Measurement, and Control*, 102(2), 69-76.
- 원저: 효율적인 역동역학 계산 알고리즘

[10] Wang, L. (2024). "Robotics Dynamics and Lagrangian Formulation". *Robotics Unveiled*.
- URL: https://www.roboticsunveiled.com/robotics-dynamics-lagrangian-formulation/
- Modern perspective on Lagrangian dynamics in robotics

[11] Robotics Underactuated (MIT). "Multi-Body Dynamics". 
- URL: https://underactuated.mit.edu/multibody.html
- Contemporary treatment of Lagrangian dynamics and virtual work

[12] Villate, J. (2023). "Lagrangian Dynamics". *Dynamics and Vibrations*.
- URL: https://villate.org/dynamics/lagrangian_dynamics.html
- Educational resource on Lagrangian mechanics principles

---

## 🔗 연결 분야
- **상위**: [[운동해석]]
- **관련**: [[순동역학해석]], [[가속도해석]], [[뉴턴오일러방법]]
- **응용**: [[로봇제어기법]], [[궤적계획]]

## 태그
#역동역학 #뉴턴오일러 #라그랑지안 #로봇제어 #계산토크제어