# 해석자코비안 (Analytic Jacobian)

> 상위: [[자코비안분석]] | 기본: [[자코비안]] | 대비: [[기하자코비안]]

위치와 자세를 나타내는 최소 매개변수들의 시간 미분으로부터 직접 유도되는 자코비안으로, 순기구학 방정식의 해석적 미분을 통해 계산됩니다.

## 🎯 기본 개념

### 정의
해석자코비안은 말단 장치의 위치와 자세를 나타내는 최소 매개변수 벡터 x의 시간 미분과 관절 속도 사이의 관계를 나타냅니다.

```
ẋ = J_a(θ) θ̇
```

여기서:
- ẋ: 위치와 자세 매개변수의 시간 미분 (6×1 또는 더 적은 차원)
- J_a(θ): 해석자코비안
- θ̇: 관절 속도 벡터 (n×1)

### 매개변수 구성
```
x = [position]  = [px, py, pz, φx, φy, φz]^T
    [orientation]
```

일반적인 자세 표현:
- **오일러각**: [α, β, γ]
- **RPY각**: [roll, pitch, yaw]
- **축-각 표현**: [θx, θy, θz]

## 📐 유도 과정

### 1단계: 순기구학 방정식
```
x = f(θ)
```

여기서 f(θ)는 관절 변수에서 작업공간 좌표로의 매핑입니다.

### 2단계: 해석적 미분
```
ẋ = ∂f/∂θ θ̇ = J_a(θ) θ̇
```

### 3단계: 자코비안 계산
```
J_a = ∂f/∂θ = [∂f₁/∂θ₁  ∂f₁/∂θ₂  ...  ∂f₁/∂θₙ]
                [∂f₂/∂θ₁  ∂f₂/∂θ₂  ...  ∂f₂/∂θₙ]
                [   ⋮         ⋮      ⋱      ⋮   ]
                [∂f₆/∂θ₁  ∂f₆/∂θ₂  ...  ∂f₆/∂θₙ]
```

## 🔧 자세 표현별 계산

### 오일러각 (ZYZ 순서)
자세가 오일러각 [φ, θ, ψ]로 표현될 때:

```
ω = [φ̇ sin θ sin ψ + θ̇ cos ψ]
    [φ̇ sin θ cos ψ - θ̇ sin ψ]
    [φ̇ cos θ + ψ̇]
```

변환 행렬:
```
T_euler = [sin θ sin ψ   cos ψ   0]
          [sin θ cos ψ  -sin ψ   0]
          [cos θ         0       1]
```

따라서: ω = T_euler * [φ̇; θ̇; ψ̇]

### RPY각 (Roll-Pitch-Yaw)
자세가 RPY각 [φ, θ, ψ]로 표현될 때:

```
T_rpy = [1   0      -sin θ]
        [0   cos φ   sin φ cos θ]
        [0  -sin φ   cos φ cos θ]
```

### 축-각 표현
단위 축 k와 회전각 θ로 표현할 때:

```
ω = (sin θ/θ) k̇ + (1 - cos θ)/θ² (k × k̇) + θ̇ k
```

## 📊 기하자코비안과의 관계

### 변환 관계
```
[v] = [I    0  ] [ẋ]   = T_analytic [ẋ]
[ω]   [0  T_ω] [α̇]                [α̇]
```

여기서:
- v, ω: 기하학적 속도
- ẋ, α̇: 해석적 속도
- T_ω: 자세 표현에 따른 변환 행렬

### 자코비안 변환
```
J_geometric = T_analytic * J_analytic
```

## 📈 계산 예제

### 2R 평면 로봇
순기구학:
```
x = L₁cos(θ₁) + L₂cos(θ₁+θ₂)
y = L₁sin(θ₁) + L₂sin(θ₁+θ₂)
φ = θ₁ + θ₂
```

해석자코비안:
```
J_a = [∂x/∂θ₁  ∂x/∂θ₂]   = [(-L₁s₁ - L₂s₁₂)  (-L₂s₁₂)]
      [∂y/∂θ₁  ∂y/∂θ₂]     [(L₁c₁ + L₂c₁₂)   (L₂c₁₂) ]
      [∂φ/∂θ₁  ∂φ/∂θ₂]     [1                 1       ]
```

### 6-DOF 매니퓰레이터 (RPY 자세)
위치 부분:
```
J_a_pos = ∂p/∂θ
```

자세 부분 (RPY):
```
J_a_ori = T_rpy⁻¹ * J_geometric_angular
```

## ⚙️ 계산 알고리즘

### 수치적 미분
```matlab
function J_a = analytic_jacobian_numerical(forward_kinematics, theta, epsilon)
    % 수치적 미분을 통한 해석자코비안 계산
    
    n = length(theta);
    x_0 = forward_kinematics(theta);
    m = length(x_0);
    J_a = zeros(m, n);
    
    for i = 1:n
        theta_plus = theta;
        theta_plus(i) = theta_plus(i) + epsilon;
        x_plus = forward_kinematics(theta_plus);
        
        J_a(:, i) = (x_plus - x_0) / epsilon;
    end
end
```

### 해석적 미분
```matlab
function J_a = analytic_jacobian_symbolic(theta)
    % 기호적 미분을 통한 해석자코비안 계산
    
    syms th1 th2 th3 th4 th5 th6 real
    theta_sym = [th1; th2; th3; th4; th5; th6];
    
    % 순기구학 정의
    x_sym = forward_kinematics_symbolic(theta_sym);
    
    % 자코비안 계산
    J_a_sym = jacobian(x_sym, theta_sym);
    
    % 수치값 대입
    J_a = double(subs(J_a_sym, theta_sym, theta));
end
```

## 🎯 특성 및 응용

### 장점
- **직관적 해석**: 작업공간 좌표의 직접적 미분
- **최소 표현**: 중복 없는 최소 매개변수 사용
- **제어 적합성**: 작업공간 제어에 직접 활용

### 단점
- **특이점 문제**: 자세 표현의 특이점에서 문제 발생
- **계산 복잡성**: 복잡한 미분 계산 필요
- **표현 의존성**: 선택한 자세 표현에 민감

### 제어 응용
```matlab
% 작업공간 PD 제어
x_error = x_desired - x_current;
x_dot_command = Kp * x_error + Kd * x_dot_error;
theta_dot = pinv(J_a) * x_dot_command;
```

## ⚠️ 특이점 문제

### 자세 표현 특이점
- **오일러각**: θ = ±π/2에서 짐벌 락
- **RPY각**: pitch = ±π/2에서 특이점
- **축-각**: θ = 0에서 축 방향 불확정

### 해결 방법
1. **쿼터니언 사용**: 특이점 없는 자세 표현
2. **동적 선택**: 특이점 근처에서 표현 방법 변경
3. **정규화**: 특이점 근처에서 수치적 안정화

## 📚 참고 문헌

### 주요 교과서
1. **Craig, J. J. (2005)**. *Introduction to Robotics: Mechanics and Control* (4th ed.). Pearson.
   - Chapter 5: Velocities, Static Forces, and Jacobians
   - 해석적 접근법의 기초

2. **Spong, M. W., Hutchinson, S., & Vidyasagar, M. (2020)**. *Robot Modeling and Control* (2nd ed.). Wiley.
   - Chapter 4: Velocity Kinematics
   - 해석적 vs 기하학적 자코비안 비교

3. **Siciliano, B., Sciavicco, L., Villani, L., & Oriolo, G. (2010)**. *Robotics: Modelling, Planning and Control*. Springer.
   - Chapter 3: Differential Kinematics
   - 상세한 해석적 유도

### 자세 표현 관련
- **Kuipers, J. B. (1999)**. *Quaternions and Rotation Sequences*. Princeton University Press.
- **Shepperd, S. W. (1978)**. "Quaternion from rotation matrix". *Journal of Guidance and Control*, 1(3), 223-224.

### 소프트웨어 도구
- [Symbolic Math Toolbox (MATLAB)](https://www.mathworks.com/products/symbolic.html)
- [SymPy (Python)](https://www.sympy.org/)
- [CasADi](https://web.casadi.org/)

---

## 🔗 연결 문서
- 상위: [[자코비안분석]]
- 기본: [[자코비안]]
- 비교: [[기하자코비안]], [[공간자코비안]], [[물체자코비안]]
- 기초: [[순기구학]], [[회전표현]], [[오일러각]], [[사원수]]
- 응용: [[속도기구학]], [[제어시스템]]