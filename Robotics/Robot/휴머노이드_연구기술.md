# 휴머노이드 연구 기술

> 상위: [[휴머노이드]]

휴머노이드 로봇의 핵심 연구 기술들과 수학적 기반을 다룹니다. 이족 보행, 전신 제어, 궤적 최적화 등의 기술적 도전과 해결 방법을 포함합니다.

## 🚶 이족 보행 제어 기술

### 1. ZMP (Zero Moment Point)

#### 개념과 정의
- **정의**: 수평 관성력과 중력의 합이 0인 지점
- **물리적 의미**: 발과 지면 접촉 시 수평 방향 모멘트가 0이 되는 점
- **안정성 기준**: ZMP가 지지 영역(발바닥) 내부에 있을 때 안정

#### 수학적 표현
```
ZMP 조건: Σ(수평 모멘트) = 0
- 중력에 의한 모멘트 + 관성력에 의한 모멘트 = 0
- ZMP 위치 = (Mx_total / Fz_total, My_total / Fz_total)
```

#### ZMP 기반 제어
- **정적 안정**: ZMP를 지지 영역 중앙에 유지
- **동적 안정**: ZMP 궤적을 미리 계획하여 추종
- **가변 ZMP**: 허용 영역 내에서 ZMP를 움직여 에너지 효율 향상
- **ZMP 추적 제어**: 목표 ZMP와 실제 ZMP 차이를 비용함수에 포함

#### 실제 응용
- Honda ASIMO: ZMP 피드백 기반 보행
- PAL Robotics REEM-C: 퍼지 로직 PD 컨트롤러로 ZMP 추적
- 질량중심(CoM) 위치 조정으로 ZMP 제어

### 2. 보행 모델

#### Linear Inverted Pendulum Model (LIPM)
- **가정**: 로봇을 역진자 모델로 단순화
- **장점**: 수학적으로 해석 가능, 실시간 계산 가능
- **한계**: 상체 움직임과 다리 질량 무시

#### Cart-Table Model
- **구성**: 상체(Cart) + 다리(Table)
- **용도**: CoM/ZMP 보행 패턴 변환
- **특성**: 보폭, 보행시간, CoM 높이 변화 분석

#### 3D LIPM
- **확장**: 2차원을 3차원으로 확장
- **고려사항**: 좌우 방향 안정성 포함
- **복잡성**: 비선형, 비볼록 최적화 문제

### 3. 보행 패턴 생성

#### 궤적 계획 방법
- **특징점 기반**: ZMP 궤적을 구간별 선형 보간
- **스플라인 보간**: 부드러운 궤적 생성
- **최적화 기반**: 에너지 최소화 목표함수

#### 보행 단계
1. **초기 단계**: 정지 상태에서 보행 시작
2. **주기 단계**: 안정적인 반복 보행
3. **종료 단계**: 보행에서 정지로 전환

## 🎯 기구학 및 역학

### 1. 순기구학 (Forward Kinematics)

#### 정의와 목적
- **변환**: 관절 각도 → 엔드 이펙터 위치/방향
- **수식**: x = f(q), 여기서 q는 관절 각도 벡터
- **방법**: DH Parameter 기반 변환 행렬

#### DH Parameter
```
변환 행렬 = Rot(z,θ) × Trans(z,d) × Trans(x,a) × Rot(x,α)
- θ: 관절 각도
- d: 링크 오프셋
- a: 링크 길이  
- α: 링크 비틀림
```

#### 계산 과정
1. 각 관절별 DH Parameter 설정
2. 개별 변환 행렬 계산
3. 연쇄적 행렬 곱셈으로 최종 위치 산출

### 2. 역기구학 (Inverse Kinematics)

#### 정의와 도전
- **변환**: 엔드 이펙터 목표 위치 → 관절 각도
- **수식**: q = f⁻¹(x)
- **어려움**: 비선형 방정식, 다중해 또는 해가 없는 경우

#### 해결 방법

##### 해석적 방법
- **기하학적 접근**: 삼각법과 기하학 이용
- **대수적 접근**: 연립방정식 해법
- **장점**: 정확한 해, 빠른 계산
- **단점**: 복잡한 로봇에는 적용 어려움

##### 수치적 방법
- **뉴턴-랩슨 방법**: 반복적 근사해법
- **경사하강법**: 오차 함수 최소화
- **의사역행렬**: 자코비안 기반 근사해

#### 특수 상황 처리
- **작업공간 벗어남**: 도달 불가능한 목표점
- **특이점**: 자코비안 행렬식이 0인 지점
- **다중해**: 여러 가능한 관절 구성

### 3. 자코비안 (Jacobian)

#### 정의와 의미
- **수학적 정의**: 다변수 함수의 1차 편미분 행렬
- **로봇공학**: 관절 속도와 엔드 이펙터 속도 관계
- **선형화**: 비선형 변환을 국소적으로 선형 근사

#### 자코비안 행렬
```
J = ∂f/∂q = [∂x/∂q₁  ∂x/∂q₂  ...  ∂x/∂qₙ]
속도 관계: ẋ = J(q) × q̇
```

#### 기하학적 자코비안
- **선속도**: 각 관절이 엔드 이펙터 선속도에 기여
- **각속도**: 각 관절이 엔드 이펙터 각속도에 기여
- **구성**: [선속도 자코비안; 각속도 자코비안]

#### 특이점 (Singularity)
- **발생**: det(J) = 0일 때
- **문제**: 역자코비안 존재하지 않음
- **해결**: 특이점 회피 알고리즘, 감쇠 최소제곱법

#### 응용
- **속도 제어**: 목표 속도로 관절 속도 계산
- **역기구학**: 반복적 해법에 활용
- **힘 제어**: 힘과 토크 관계 변환

## 🔄 전신 제어 기술

### 1. 다중 태스크 제어

#### 계층적 제어 (Hierarchical Control)
- **우선순위**: 균형 > 보행 > 상체 작업
- **Null Space**: 고우선순위 태스크를 방해하지 않는 범위에서 저우선순위 수행
- **수식**: q̇ = J₁⁺x₁ + (I - J₁⁺J₁)J₂⁺x₂

#### 가중 제어 (Weighted Control)  
- **가중합**: 여러 태스크를 가중치로 결합
- **실시간 조정**: 상황에 따라 가중치 동적 변경
- **최적화**: 2차 계획법으로 최적해 계산

### 2. 중복 자유도 (Redundancy) 활용

#### 개념
- **정의**: 태스크 수행에 필요한 것보다 많은 관절
- **휴머노이드**: 30+ DOF로 높은 중복성
- **장점**: 다양한 자세, 특이점 회피, 제약 만족

#### 중복성 해결 방법
- **의사역행렬**: 최소 노름 해
- **가중 의사역행렬**: 관절별 중요도 고려
- **점진적 목표**: 보조 목표 함수 설정

### 3. 제약 조건 처리

#### 물리적 제약
- **관절 한계**: 각도, 속도, 토크 제한
- **충돌 회피**: 자가 충돌 및 환경 충돌
- **균형 유지**: ZMP 제약

#### 수학적 표현
```
minimize: ||J(q)q̇ - ẋd||²
subject to: qmin ≤ q ≤ qmax
           q̇min ≤ q̇ ≤ q̇max
           ZMP ∈ Support polygon
```

## 📊 궤적 최적화

### 1. 문제 정의

#### 목적 함수
- **에너지 최소화**: ∫τᵀτ dt (토크 제곱합)
- **시간 최소화**: 최단 시간 경로
- **부드러움**: ∫q̈ᵀq̈ dt (가속도 제곱합)
- **안정성**: ZMP 마진 최대화

#### 제약 조건
- **초기/종료**: 시작점과 끝점 조건
- **경유점**: 중간 통과점
- **물리적 한계**: 관절, 속도, 가속도 제한
- **충돌 회피**: 장애물 제약

### 2. 최적화 기법

#### 직접 최적화
- **콜로케이션**: 연속 문제를 이산화
- **다중 사격법**: 경계값 문제 해법
- **의사 스펙트럼**: 체비셰프 다항식 이용

#### 간접 최적화
- **변분법**: 오일러-라그랑주 방정식
- **최적 제어**: 해밀턴-야코비-벨만 방정식
- **수치 해법**: 다중 점 경계값 문제

#### 비선형 계획법
- **SQP**: Sequential Quadratic Programming
- **내점법**: Interior Point Method
- **유전 알고리즘**: 전역 최적화

### 3. 실시간 최적화

#### Model Predictive Control (MPC)
- **예측 모델**: 시스템 동역학 모델
- **순환 최적화**: 매 제어 주기마다 최적화
- **제약 만족**: 실시간 제약 조건 처리

#### 적응형 동작 최적화 (AMO)
- **sim-to-real**: 시뮬레이션과 실제 환경 연결
- **강화학습 결합**: RL + 궤적 최적화
- **실시간 적응**: 환경 변화에 즉시 대응

## 🧠 학습 기반 제어

### 1. 강화학습 (Reinforcement Learning)

#### 기본 개념
- **환경**: 로봇과 주변 환경
- **상태**: 관절 각도, 속도, 위치 등
- **행동**: 관절 토크 또는 목표 위치
- **보상**: 태스크 성공도, 에너지 효율성 등

#### 휴머노이드 적용
- **보행 학습**: 안정적 이족 보행 패턴 학습
- **균형 제어**: 외란에 대한 동적 균형 대응
- **전신 협조**: 복합 태스크 동시 수행

#### 주요 알고리즘
- **PPO**: Proximal Policy Optimization
- **SAC**: Soft Actor-Critic  
- **TD3**: Twin Delayed Deep Deterministic policy gradient

### 2. 모방학습 (Imitation Learning)

#### 행동 복제 (Behavior Cloning)
- **데이터**: 전문가 시연 데이터
- **학습**: 지도학습으로 정책 학습
- **장점**: 안정적, 빠른 학습
- **단점**: 분포 이동 문제

#### 모션 캡처 활용
- **인간 동작**: 모션 캡처로 인간 움직임 기록
- **변환**: 인간 골격을 로봇 관절로 매핑
- **최적화**: 로봇 제약에 맞게 동작 조정

#### 대화형 모방학습
- **DAgger**: Dataset Aggregation
- **전문가 피드백**: 학습 중 전문가 개입
- **점진적 개선**: 반복적 데이터 수집과 학습

### 3. 하이브리드 접근법

#### 모델 기반 + 학습 기반
- **초기화**: 모델 기반으로 초기 정책
- **개선**: 강화학습으로 성능 향상
- **안전성**: 모델 기반 제약으로 안전 보장

#### 계층적 학습
- **상위 레벨**: 태스크 계획 및 목표 설정
- **하위 레벨**: 모터 제어 및 안정화
- **모듈화**: 각 레벨 독립적 학습 가능

## 🔧 센서 융합 및 상태 추정

### 1. 센서 시스템

#### 관성 센서 (IMU)
- **가속도계**: 선형 가속도 측정
- **자이로스코프**: 각속도 측정
- **자력계**: 방향 기준 제공
- **융합**: 상보 필터, 칼만 필터

#### 시각 센서
- **RGB 카메라**: 색상 영상 정보
- **깊이 카메라**: 거리 정보
- **스테레오 비전**: 3D 구조 복원
- **LiDAR**: 고정밀 거리 측정

#### 촉각 센서
- **힘/토크 센서**: 발과 지면 간 상호작용력
- **압력 센서**: 접촉 압력 분포
- **관절 센서**: 관절 위치, 속도, 토크

### 2. 상태 추정 알고리즘

#### 칼만 필터 (Kalman Filter)
- **선형 시스템**: 가우시안 노이즈 가정
- **예측**: 시스템 모델 기반 상태 예측
- **업데이트**: 센서 측정으로 상태 보정

#### 확장 칼만 필터 (EKF)
- **비선형 시스템**: 자코비안으로 선형화
- **로봇 적용**: 비선형 동역학 시스템
- **한계**: 강한 비선형성에서 성능 저하

#### 파티클 필터
- **비선형/비가우시안**: 일반적인 확률 분포
- **샘플링**: 파티클로 확률 분포 표현
- **재샘플링**: 가중치 기반 파티클 선택

### 3. SLAM (Simultaneous Localization and Mapping)

#### 개념
- **동시 수행**: 위치 추정과 지도 작성
- **센서**: 카메라, LiDAR, IMU 융합
- **응용**: 미지 환경에서 내비게이션

#### 주요 방법
- **시각적 SLAM**: 카메라 기반 (ORB-SLAM, VINS)
- **LiDAR SLAM**: 레이저 스캐너 기반
- **융합 SLAM**: 여러 센서 결합

## 🔬 고급 연구 주제

### 1. 적응 제어 (Adaptive Control)

#### 매개변수 적응
- **미지 매개변수**: 로봇 질량, 관성 등
- **실시간 추정**: 매개변수 온라인 학습
- **안정성**: 리아푸노프 안정성 보장

#### 견고 제어 (Robust Control)
- **불확실성**: 모델 오차, 외란
- **H∞ 제어**: 최악 경우 성능 보장
- **슬라이딩 모드**: 불연속 제어로 견고성 확보

### 2. 최적 제어

#### Linear Quadratic Regulator (LQR)
- **선형 시스템**: 선형 동역학, 2차 비용
- **리카티 방정식**: 최적 피드백 게인
- **무한 수평**: 정상상태 최적 제어

#### Differential Dynamic Programming (DDP)
- **비선형 최적 제어**: 비선형 시스템
- **2차 근사**: 값 함수의 2차 근사
- **순방향-역방향**: 반복적 해법

### 3. 확률적 제어

#### 확률적 최적 제어
- **불확실성**: 노이즈, 측정 오차
- **기댓값 최적화**: 확률적 비용 함수
- **동적 계획법**: 벨만 방정식

#### 베이지안 추론
- **사전 지식**: 이전 경험 활용
- **사후 업데이트**: 새로운 관측으로 업데이트
- **불확실성 정량화**: 확률적 추정

## 🔧 구현 및 검증

### 1. 시뮬레이션 환경

#### 물리 엔진
- **강체 동역학**: 관절과 링크 모델링
- **접촉 모델**: 발-지면 상호작용
- **마찰 모델**: 정적/동적 마찰

#### 주요 시뮬레이터
- **Gazebo**: ROS 연동, 물리 시뮬레이션
- **MuJoCo**: 연속 제어 최적화
- **PyBullet**: 파이썬 기반 물리 엔진
- **CasADi**: 최적화 문제 모델링

### 2. 실험 및 검증

#### 성능 지표
- **안정성**: 넘어지지 않고 보행한 거리
- **에너지 효율**: 단위 거리당 에너지 소비
- **속도**: 최대 보행 속도
- **적응성**: 외란에 대한 회복 능력

#### 실험 프로토콜
- **제어된 환경**: 실험실 조건
- **다양한 지형**: 평지, 경사, 계단
- **외란 테스트**: 밀기, 장애물
- **장시간 테스트**: 내구성 검증

### 3. 안전 고려사항

#### 하드웨어 안전
- **비상 정지**: 즉시 모든 모터 정지
- **소프트 제한**: 관절 한계 보호
- **힘 제한**: 과도한 힘 방지

#### 소프트웨어 안전
- **예외 처리**: 센서 오류, 통신 실패
- **상태 감시**: 비정상 상태 감지
- **점진적 테스트**: 단계별 검증

## 🔗 연결 분야

### 기반 수학
- **선형대수**: [[회전행렬]], [[자코비안분석]]
- **미분방정식**: [[라그랑지역학]], [[해밀토니안동역학]]
- **최적화**: [[비선형최적화]], [[제약최적화]]

### 제어 이론
- **고전제어**: [[PID제어기]], [[주파수응답]]
- **현대제어**: [[상태공간]], [[최적제어]]
- **적응제어**: [[매개변수추정]], [[견고제어]]

### 인공지능
- **기계학습**: [[강화학습]], [[심층학습]]
- **확률론**: [[베이지안추론]], [[칼만필터]]
- **최적화**: [[유전알고리즘]], [[입자군최적화]]

### 응용 분야
- **이동로봇**: [[SLAM]], [[경로계획]]
- **조작로봇**: [[힘제어]], [[충돌회피]]
- **센서융합**: [[상태추정]], [[신호처리]]

## 📚 주요 참고 문헌

### 기본 교재
- Siciliano, B. et al., "Robotics: Modelling, Planning and Control"
- Craig, J.J., "Introduction to Robotics: Mechanics and Control"
- Spong, M.W. et al., "Robot Modeling and Control"

### 고급 연구서
- Vukobratović, M., "Biped Locomotion"
- Kajita, S. et al., "Introduction to Humanoid Robotics"
- Pratt, J. et al., "Legged Robots that Balance"

### 최신 논문
- Trajectory Optimization for Humanoid Robots (IEEE Robotics & Automation)
- Learning-based Control for Humanoid Walking (Science Robotics)
- Multi-task Control for Humanoid Robots (International Journal of Robotics Research)

## 태그

#휴머노이드연구 #ZMP #궤적최적화 #역기구학 #자코비안 #전신제어 #강화학습 #모방학습 #센서융합 #최적제어