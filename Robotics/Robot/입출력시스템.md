# μ…μ¶λ ¥μ‹μ¤ν…

> μƒμ„: [[μ „μνλ΅μ„¤κ³„]]

λ§μ΄ν¬λ΅μ»¨νΈλ΅¤λ¬μ™€ μ™Έλ¶€ μ¥μΉ κ°„ μΈν„°νμ΄μ¤ μ„¤κ³„μ™€ κµ¬ν„ λ°©λ²•μ…λ‹λ‹¤.

## π“ MCUλ³„ ν†µμ‹  μΈν„°νμ΄μ¤ λΉ„κµ

### Arduino (ATmega328P)
```
UART: 1κ° (Serial)
SPI: 1κ° (Hardware SPI)
I2C: 1κ° (Wire)
GPIO: 14κ° λ””μ§€ν„Έ, 6κ° μ•„λ‚ λ΅κ·Έ
ADC: 10bit, 6μ±„λ„
PWM: 6μ±„λ„
μΈν„°λ½νΈ: 2κ° μ™Έλ¶€ μΈν„°λ½νΈ (PIN 2, 3)

νΉμ§•: κ°„λ‹¨ν• κµ¬μ΅°, μ΄λ³΄μ μΉν™”μ 
μ©λ„: ν”„λ΅ν† νƒ€μ΄ν•‘, κ°„λ‹¨ν• λ΅λ΄‡
```

### ESP32
```
UART: 3κ° (Serial, Serial1, Serial2)
SPI: 2κ° (HSPI, VSPI)
I2C: 2κ° (Wire, Wire1)
GPIO: 34κ° (μΌλ¶€ μ…λ ¥ μ „μ©)
ADC: 12bit, 18μ±„λ„ (2κ° ADC)
DAC: 8bit, 2μ±„λ„
PWM: LEDC 16μ±„λ„
μΈν„°λ½νΈ: λ¨λ“  GPIO ν•€
WiFi/Bluetooth: λ‚΄μ¥
CAN: 1κ° (μ™Έλ¶€ νΈλμ‹λ²„ ν•„μ”)
Touch: 10κ° ν„°μΉ μ„Όμ„

νΉμ§•: λ¬΄μ„  ν†µμ‹  λ‚΄μ¥, λ“€μ–Ό μ½”μ–΄
μ©λ„: IoT λ΅λ΄‡, λ¬΄μ„  μ μ–΄ μ‹μ¤ν…
```
### STM32 (F4 μ‹λ¦¬μ¦)
```
UART/USART: μµλ€ 6κ°
SPI: μµλ€ 3κ°
I2C: μµλ€ 3κ°
GPIO: 80+ ν•€ (λ¨λΈμ— λ”°λΌ)
ADC: 12bit, μµλ€ 24μ±„λ„ (3κ° ADC)
DAC: 12bit, 2μ±„λ„
PWM: λ‹¤μ νƒ€μ΄λ¨Έ κΈ°λ°
μΈν„°λ½νΈ: λ¨λ“  GPIO ν•€
CAN: 2κ° (λ‚΄μ¥ νΈλμ‹λ²„)
USB: OTG μ§€μ›
DMA: κ³ μ„±λ¥ λ°μ΄ν„° μ „μ†΅
νƒ€μ΄λ¨Έ: 14κ° (κ³ κΈ‰ μ μ–΄)

νΉμ§•: κ³ μ„±λ¥, μ‹¤μ‹κ°„ μ²λ¦¬
μ©λ„: μ‚°μ—…μ© λ΅λ΄‡, μ •λ°€ μ μ–΄
```

## π”„ ν΄λ§ vs μΈν„°λ½νΈ

### ν΄λ§ (Polling) λ°©μ‹
```cpp
// Arduino ν΄λ§ μμ‹
void loop() {
    if(digitalRead(SENSOR_PIN) == HIGH) {
        // μ„Όμ„ κ°μ§€μ‹ μ²λ¦¬
        processSensorData();
    }
    
    if(Serial.available() > 0) {
        // μ‹λ¦¬μ–Ό λ°μ΄ν„° μμ‹ μ‹ μ²λ¦¬
        String data = Serial.readString();
    }
    
    delay(10);  // 10ms μ£ΌκΈ°
}

μ¥μ : κ°„λ‹¨ν• κµ¬ν„, λ””λ²„κΉ… μ©μ΄
λ‹¨μ : CPU μμ› λ‚­λΉ„, λ°μ‘μ†λ„ μ ν•
```
### μΈν„°λ½νΈ (Interrupt) λ°©μ‹
```cpp
// ESP32 μΈν„°λ½νΈ μμ‹
volatile bool sensorTriggered = false;
volatile long encoderCount = 0;

void IRAM_ATTR sensorISR() {
    sensorTriggered = true;
}

void IRAM_ATTR encoderISR() {
    encoderCount++;
}

void setup() {
    attachInterrupt(digitalPinToInterrupt(2), sensorISR, RISING);
    attachInterrupt(digitalPinToInterrupt(3), encoderISR, CHANGE);
}

void loop() {
    if(sensorTriggered) {
        sensorTriggered = false;
        processSensorEvent();
    }
    
    // λ‹¤λ¥Έ μ‘μ—… μν–‰ κ°€λ¥
    doOtherTasks();
}

μ¥μ : μ‹¤μ‹κ°„ λ°μ‘, ν¨μ¨μ  CPU μ‚¬μ©
λ‹¨μ : λ³µμ΅ν• κµ¬ν„, λ™κΈ°ν™” λ¬Έμ  κ°€λ¥
```

## π“΅ MCUλ³„ ν†µμ‹  κµ¬ν„

### Arduino ν†µμ‹  μμ‹
```cpp
// UART ν†µμ‹ 
Serial.begin(9600);
Serial.println("Hello World");

// I2C λ§μ¤ν„°
#include <Wire.h>
Wire.begin();
Wire.beginTransmission(0x68);
Wire.write(0x3B);
Wire.endTransmission();
Wire.requestFrom(0x68, 6);

// SPI ν†µμ‹ 
#include <SPI.h>
SPI.begin();
SPI.transfer(0xAA);
```
### ESP32 ν†µμ‹  μμ‹
```cpp
// λ©€ν‹° UART
Serial.begin(115200);    // USB μ‹λ¦¬μ–Ό
Serial1.begin(9600, SERIAL_8N1, 16, 17);   // GPIO 16,17
Serial2.begin(115200, SERIAL_8N1, 32, 33); // GPIO 32,33

// λ©€ν‹° I2C
Wire.begin(21, 22);      // SDA=21, SCL=22
Wire1.begin(25, 26);     // SDA=25, SCL=26

// λ©€ν‹° SPI
SPI.begin(18, 19, 23, 5);    // SCK, MISO, MOSI, SS
HSPI.begin();

// CAN λ²„μ¤
#include <CAN.h>
CAN.setPins(5, 35);  // TX, RX
CAN.begin(500E3);    // 500kbps

// WiFi
#include <WiFi.h>
WiFi.begin("SSID", "password");

// Bluetooth
#include "BluetoothSerial.h"
BluetoothSerial SerialBT;
SerialBT.begin("ESP32-Robot");
```
### STM32 ν†µμ‹  μμ‹ (HAL λΌμ΄λΈλ¬λ¦¬)
```cpp
// UART ν†µμ‹ 
HAL_UART_Transmit(&huart1, (uint8_t*)"Hello", 5, 1000);
HAL_UART_Receive_IT(&huart1, rxBuffer, 10);

// I2C ν†µμ‹ 
HAL_I2C_Master_Transmit(&hi2c1, 0x68<<1, txData, 2, 1000);
HAL_I2C_Master_Receive(&hi2c1, 0x68<<1, rxData, 6, 1000);

// SPI ν†µμ‹ 
HAL_SPI_Transmit(&hspi1, txData, 4, 1000);
HAL_SPI_Receive(&hspi1, rxData, 4, 1000);

// CAN ν†µμ‹ 
CAN_TxHeaderTypeDef txHeader;
txHeader.StdId = 0x123;
txHeader.DLC = 8;
HAL_CAN_AddTxMessage(&hcan1, &txHeader, txData, &txMailbox);

// DMA ν™μ© (κ³ μ† λ°μ΄ν„° μ „μ†΅)
HAL_UART_Transmit_DMA(&huart1, txBuffer, 1024);
HAL_ADC_Start_DMA(&hadc1, adcBuffer, 100);
```

## β΅ μ‹¤λ¬΄ ν™μ© ν¨ν„΄

### μ„Όμ„ λ°μ΄ν„° μμ§‘ μ‹μ¤ν…
```cpp
// ESP32 λ©€ν‹° μ„Όμ„ μ‹μ¤ν…
void setupSensors() {
    // I2C μ„Όμ„λ“¤
    Wire.begin(21, 22);
    setupIMU();        // MPU9250
    setupPressure();   // BMP280
    
    // SPI μ„Όμ„
    SPI.begin(18, 19, 23);
    setupHighSpeedSensor();
    
    // μ•„λ‚ λ΅κ·Έ μ„Όμ„
    setupLoadCell();   // ADC μ±„λ„
    
    // μ—”μ½”λ” (μΈν„°λ½νΈ)
    attachInterrupt(digitalPinToInterrupt(2), encoderISR, CHANGE);
}
```
### λ¨ν„° μ μ–΄ μ‹μ¤ν…
```cpp
// STM32 κ³ μ„±λ¥ λ¨ν„° μ μ–΄
void setupMotorControl() {
    // PWM νƒ€μ΄λ¨Έ μ„¤μ • (3μƒ BLDC)
    HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_1);  // Uμƒ
    HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_2);  // Vμƒ
    HAL_TIM_PWM_Start(&htim1, TIM_CHANNEL_3);  // Wμƒ
    
    // μ—”μ½”λ” μΈν„°νμ΄μ¤
    HAL_TIM_Encoder_Start(&htim2, TIM_CHANNEL_ALL);
    
    // CAN ν†µμ‹  (λ¨ν„° λ“λΌμ΄λ²„ μ μ–΄)
    HAL_CAN_Start(&hcan1);
    HAL_CAN_ActivateNotification(&hcan1, CAN_IT_RX_FIFO0_MSG_PENDING);
}

// ESP32 κ°„λ‹¨ν• λ¨ν„° μ μ–΄
void setupSimpleMotor() {
    // PWM μ±„λ„ μ„¤μ •
    ledcSetup(0, 20000, 8);  // 20kHz, 8bit
    ledcAttachPin(12, 0);    // λ¨ν„° PWM
    
    // λ°©ν–¥ μ μ–΄
    pinMode(13, OUTPUT);     // DIR1
    pinMode(14, OUTPUT);     // DIR2
}
```

### ν†µμ‹  λ„¤νΈμ›ν¬ κµ¬μ„±
```cpp
// λ΅λ΄‡ μ‹μ¤ν… ν†µμ‹  μ•„ν‚¤ν…μ²
// λ§μ¤ν„° (ESP32) β†’ μ¬λ μ΄λΈλ“¤ (Arduino/STM32)

// ESP32 λ§μ¤ν„°
void setupRobotNetwork() {
    // μ„Όμ„ λ¨λ“κ³Ό I2C ν†µμ‹ 
    Wire.begin(21, 22);
    
    // λ¨ν„° μ»¨νΈλ΅¤λ¬μ™€ CAN ν†µμ‹ 
    CAN.setPins(5, 35);
    CAN.begin(500E3);
    
    // μƒμ„ μ‹μ¤ν…κ³Ό WiFi ν†µμ‹ 
    WiFi.begin("RobotNetwork", "password");
    
    // μ‚¬μ©μ μΈν„°νμ΄μ¤μ™€ Bluetooth
    SerialBT.begin("Robot-Control");
}
```

## π”§ μ„ νƒ κ°€μ΄λ“

### ν”„λ΅μ νΈλ³„ MCU μ„ νƒ
```
κ°„λ‹¨ν• ν”„λ΅ν† νƒ€μ…: Arduino Uno
- ν•™μµμ©, κ°„λ‹¨ν• μ„Όμ„ μ—°κ²°
- μ ν•μ  ν†µμ‹  μΈν„°νμ΄μ¤λ΅ μ¶©λ¶„

IoT λ΅λ΄‡: ESP32
- λ¬΄μ„  ν†µμ‹  ν•„μ
- λ‹¤μ–‘ν• μ„Όμ„ μΈν„°νμ΄μ¤ ν•„μ”
- μ λ‹Ήν• μ²λ¦¬ μ„±λ¥

μ‚°μ—…μ©/μ •λ°€ μ μ–΄: STM32
- μ‹¤μ‹κ°„ μ²λ¦¬ μ”κµ¬
- λ‹¤μμ ν†µμ‹  μΈν„°νμ΄μ¤
- κ³ μ„±λ¥ λ¨ν„° μ μ–΄
```

---

## π”— μ—°κ²° λ¬Έμ„
- μƒμ„: [[μ „μνλ΅μ„¤κ³„]]
- κ΄€λ ¨: [[ν†µμ‹ μΈν„°νμ΄μ¤]], [[λ§μ΄ν¬λ΅μ»¨νΈλ΅¤λ¬]]
- μ‘μ©: [[μ„Όμ„μΈν„°νμ΄μ¤]], [[λ¨ν„°λ“λΌμ΄λ²„]]