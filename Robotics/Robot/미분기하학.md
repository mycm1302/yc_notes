# 미분기하학

> 상위: [[선형대수및기하학]]  
> 관련: [[매니폴드]], [[리군론]], [[위상수학]]

로봇의 곡면 운동, 경로 계획, 동역학 해석에 필수적인 미분기하학(Differential Geometry)입니다. 곡률과 연결의 개념을 통해 로봇 운동의 기하학적 성질을 분석합니다.

## 🎯 미분기하학의 기초

### 매끄러운 매니폴드
```
미분가능 매니폴드 M: 
- 위상 매니폴드 + 미분구조
- 좌표 전환이 C∞ 함수
- 접선공간과 미분형식 정의 가능

차원: n = dim(M)
국소 좌표: (x¹, x², ..., xⁿ)
```

### 접선벡터와 접선공간
```
접선벡터 v ∈ T_p M:
방향 미분 연산자로 정의
v(f) = d/dt f(γ(t))|_{t=0}

기저: {∂/∂x¹, ∂/∂x², ..., ∂/∂xⁿ}
표현: v = vⁱ ∂/∂xⁱ (아인슈타인 합 규약)
```

### 벡터장 (Vector Field)
```
X: M → TM
각 점에서 접선벡터를 할당
매끄러운 벡터장: X ∈ Γ(TM)

국소 표현: X = Xⁱ ∂/∂xⁱ
```

## 🌐 리만 기하학

### 리만 계량 (Riemannian Metric)
```
g: TM × TM → ℝ
각 점에서 내적 구조 정의

성질:
1. 쌍선형성: g(au+bv, w) = ag(u,w) + bg(v,w)
2. 대칭성: g(u,v) = g(v,u)
3. 양정치성: g(v,v) > 0 (v ≠ 0)

국소 표현: g = g_{ij} dx^i ⊗ dx^j
```

### 호장길이와 거리
```
곡선 γ(t): [a,b] → M의 길이:
L(γ) = ∫ᵃᵇ √(g(γ'(t), γ'(t))) dt

리만 거리: d(p,q) = inf{L(γ) | γ는 p에서 q로의 곡선}
```

### 측지선 (Geodesic)
```
국소적으로 최단인 곡선
측지선 방정식: ∇_{γ'} γ' = 0

국소 좌표:
d²x^k/dt² + Γ^k_{ij} (dx^i/dt)(dx^j/dt) = 0

Γ^k_{ij}: 크리스토펠 기호
```

## 🔧 접속과 공변미분

### 레비-치비타 접속
```
∇: Γ(TM) × Γ(TM) → Γ(TM)
유일한 토션 없는 계량 호환 접속

성질:
1. ∇_X(Y + Z) = ∇_X Y + ∇_X Z
2. ∇_{X+Y} Z = ∇_X Z + ∇_Y Z
3. ∇_{fX} Y = f∇_X Y
4. X(g(Y,Z)) = g(∇_X Y, Z) + g(Y, ∇_X Z)
```

### 크리스토펠 기호
```
∇_{∂/∂x^i} ∂/∂x^j = Γ^k_{ij} ∂/∂x^k

계산 공식:
Γ^k_{ij} = ½g^{kl}(∂g_{il}/∂x^j + ∂g_{jl}/∂x^i - ∂g_{ij}/∂x^l)
```

### 병렬 운송
```
벡터장 V가 곡선 γ를 따라 병렬:
∇_{γ'} V = 0

기하학적 의미: 
- 자연스러운 회전 없는 운송
- 홀로노미와 곡률의 기하학적 해석
```

## 📊 곡률

### 리만 곡률 텐서
```
R(X,Y)Z = ∇_X ∇_Y Z - ∇_Y ∇_X Z - ∇_{[X,Y]} Z

국소 좌표:
R^l_{ijk} = ∂Γ^l_{ik}/∂x^j - ∂Γ^l_{ij}/∂x^k + Γ^m_{ik}Γ^l_{mj} - Γ^m_{ij}Γ^l_{mk}
```

### 단면 곡률
```
2차원 평면의 곡률:
K(X,Y) = g(R(X,Y)Y, X) / (g(X,X)g(Y,Y) - g(X,Y)²)

기하학적 의미: 가우스 곡률의 일반화
```

### 리치 곡률
```
Ric(X,Y) = tr(Z ↦ R(Z,X)Y)
= R^k_{ikj} g^{ik}

스칼라 곡률: R = g^{ij}Ric_{ij}
```

### 주곡률
```
곡면의 경우:
κ₁, κ₂: 주곡률
가우스 곡률: K = κ₁κ₂
평균 곡률: H = (κ₁ + κ₂)/2
```

## 🤖 로봇공학 응용

### 1. 구성공간의 기하학
```
로봇 구성공간 Q에 리만 계량:
- 관성 계량: M(q) (질량행렬)
- 운동 에너지: T = ½g(q̇,q̇)
- 측지선: 자유 운동 궤적
```

### 2. 작업공간의 곡률
```
장애물이 있는 환경:
- 자유공간: 비양곡률
- 좁은 통로: 음곡률
- 열린 공간: 영곡률

경로 계획: 곡률을 고려한 최적 경로
```

### 3. 로봇 동역학
```
라그랑지 방정식:
d/dt(∂L/∂q̇) - ∂L/∂q = Q

기하학적 해석:
- 측지선에서의 편차
- 곡률항과 원심력/코리올리력
```

### 4. 제어 시스템 이론
```
비홀로노믹 제약:
A(q)q̇ = 0

제약 분포: D = ker(A)
가적분성: 프로베니우스 정리
큐베이처: 리 브라켓의 곡률 해석
```

## 🎯 특수한 기하구조

### 1. 복소 매니폴드
```
켈러 계량: 복소구조와 호환
로봇학: 복소 평면에서의 운동 계획
```

### 2. 심플렉틱 기하학
```
심플렉틱 형식: ω
해밀토니안 역학과의 연결
로봇 동역학의 심플렉틱 구조
```

### 3. 접촉 기하학
```
접촉 형식: 비적분가능 1-형식
비홀로노믹 시스템의 자연스러운 설정
```

### 4. 파이버 번들
```
주번들: P(M,G)
연결 1-형식과 곡률 2-형식
게이지 이론과의 연결
```

## 🔬 계산 방법

### 1. 수치적 미분기하학
```
이산 곡률 계산:
- 삼각분할에서의 가우스 곡률
- 유한차분을 통한 크리스토펠 기호
- 측지선의 수치적 적분
```

### 2. 미분형식의 계산
```
외미분: d: Ω^k(M) → Ω^{k+1}(M)
호지 스타: *: Ω^k(M) → Ω^{n-k}(M)
코드미분: δ = (-1)^{nk+n+1} * d *
```

### 3. 특성 클래스
```
천 클래스: 복소 벡터 번들
폰트랴긴 클래스: 실 벡터 번들
오일러 클래스: 방향 벡터 번들
```

## 🚀 고급 응용

### 1. 최적 제어
```
변분 원리: δ∫L dt = 0
오일러-라그랑지 방정식
측지선과 극값 곡선의 관계

폰트랴긴 최대 원리:
해밀토니안 H(x,p,u)
수반 방정식: ṗ = -∂H/∂x
```

### 2. 기하학적 역학
```
라그랑지 역학의 기하학적 정형화:
접다발 TQ 위의 라그랑지안
레장드르 변환: TQ → T*Q

해밀토니안 역학:
여접다발 T*Q 위의 심플렉틱 구조
정준 방정식
```

### 3. 게이지 이론
```
주접속과 곡률:
연결 1-형식 A
곡률 2-형식 F = dA + A ∧ A

로봇학: 구속 시스템의 게이지 자유도
```

### 4. 이산 기하학
```
이산 외계산: 체인 복합체
이산 호지 이론: 코호몰로지
계산 위상학: 퍼시스턴트 호몰로지
```

## 🔧 구현 예제

### MATLAB
```matlab
% 곡면의 주곡률 계산
function [K, H] = principal_curvatures(X, Y, Z)
    % 1차 편미분
    Xu = gradient(X); Xv = gradient(X')';
    Yu = gradient(Y); Yv = gradient(Y')';
    Zu = gradient(Z); Zv = gradient(Z')';
    
    % 2차 편미분
    Xuu = gradient(Xu); Xuv = gradient(Xu')';
    Yuu = gradient(Yu); Yuv = gradient(Yu')';
    Zuu = gradient(Zu); Zuv = gradient(Zu')';
    
    % 법벡터
    N = cross([Xu(:), Yu(:), Zu(:)], [Xv(:), Yv(:), Zv(:)], 2);
    N = N ./ vecnorm(N, 2, 2);
    
    % 제1, 제2 기본형식
    E = Xu.^2 + Yu.^2 + Zu.^2;
    F = Xu.*Xv + Yu.*Yv + Zu.*Zv;
    G = Xv.^2 + Yv.^2 + Zv.^2;
    
    L = dot([Xuu, Yuu, Zuu], N, 2);
    M = dot([Xuv, Yuv, Zuv], N, 2);
    N_coeff = dot([Xvv, Yvv, Zvv], N, 2);
    
    % 가우스 곡률과 평균 곡률
    K = (L.*N_coeff - M.^2) ./ (E.*G - F.^2);
    H = (E.*N_coeff - 2*F.*M + G.*L) ./ (2*(E.*G - F.^2));
end
```

### Python
```python
import numpy as np
from scipy.linalg import solve

class RiemannianManifold:
    def __init__(self, metric_func):
        self.g = metric_func
    
    def christoffel(self, x, h=1e-6):
        """크리스토펠 기호 수치 계산"""
        n = len(x)
        gamma = np.zeros((n, n, n))
        
        for i in range(n):
            for j in range(n):
                for k in range(n):
                    # 계량의 편미분 계산
                    x_plus = x.copy()
                    x_minus = x.copy()
                    x_plus[k] += h
                    x_minus[k] -= h
                    
                    dg_ik_dxj = (self.g(x_plus)[i,k] - self.g(x_minus)[i,k]) / (2*h)
                    dg_jk_dxi = (self.g(x_plus)[j,k] - self.g(x_minus)[j,k]) / (2*h)
                    dg_ij_dxk = (self.g(x_plus)[i,j] - self.g(x_minus)[i,j]) / (2*h)
                    
                    # 크리스토펠 기호
                    g_inv = np.linalg.inv(self.g(x))
                    gamma[i,j,k] = 0.5 * np.sum(g_inv[i,:] * 
                                               (dg_ik_dxj + dg_jk_dxi - dg_ij_dxk))
        return gamma
    
    def geodesic_equation(self, t, y):
        """측지선 방정식"""
        n = len(y) // 2
        x = y[:n]
        v = y[n:]
        
        gamma = self.christoffel(x)
        
        # ẍ^k + Γ^k_{ij} ẋ^i ẋ^j = 0
        acceleration = np.zeros(n)
        for k in range(n):
            for i in range(n):
                for j in range(n):
                    acceleration[k] -= gamma[k,i,j] * v[i] * v[j]
        
        return np.concatenate([v, acceleration])

# 구면에서의 예제
def sphere_metric(x):
    """단위구면의 계량 (구면좌표)"""
    theta, phi = x
    return np.array([[1, 0],
                     [0, np.sin(theta)**2]])

sphere = RiemannianManifold(sphere_metric)
```

## 🎯 실제 문제들

### 1. 로봇 팔의 특이점 분석
```
자코비안의 기하학적 분석:
- 특이값과 주곡률의 관계
- 가조작성 타원체의 곡률
- 특이점 근처에서의 측지선
```

### 2. 이동로봇의 경로 계획
```
더빈 자동차 모델:
- 최소 회전반경 제약
- 곡률 제약이 있는 경로
- 리드-셰퍼 문제
```

### 3. 햅틱 피드백
```
사용자 인터페이스의 곡률:
- 가상 표면의 기하학적 성질
- 힘 피드백과 곡률의 관계
- 안정성 분석
```

## 🎯 학습 가이드

1. **기초 미분기하학** (4-5주)
   - 매니폴드와 접선공간
   - 리만 계량과 접속

2. **곡률 이론** (4-6주)
   - 리만 곡률 텐서
   - 특수한 곡률들과 기하학적 의미

3. **로봇 응용** (3-4주)
   - 구성공간의 기하학
   - 제어 이론과의 연결

4. **고급 주제** (선택, 6-8주)
   - 게이지 이론과 파이버 번들
   - 이산 기하학과 계산 방법

---
*참고: Riemannian Manifolds (Lee), Differential Geometry (Spivak), Geometric Control Theory (Bullo & Lewis), Mathematical Methods in Robotics (Park & Lynch)*