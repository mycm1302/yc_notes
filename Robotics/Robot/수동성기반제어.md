# Passivity-based Control (수동성 기반 제어)

## 1. 개요 및 배경

Passivity-based Control (PBC)은 시스템의 에너지 특성과 수동성 개념을 활용한 제어 기법입니다. 1970년대 네트워크 이론에서 시작되어, 1990년대 Ortega, Spong 등에 의해 로봇 제어에 체계적으로 도입되었습니다. 물리적 직관과 수학적 엄밀성을 결합한 우아한 제어 이론입니다.

### 1.1 수동성의 개념

**수동성 정의**: 시스템이 외부에서 공급받는 에너지보다 많은 에너지를 생성하지 않는 특성

**수학적 정의**: 
시스템이 수동적(passive)이라면, 적절한 저장 함수 S(x) ≥ 0이 존재하여:
$$S(x(t)) - S(x(0)) \leq \int_0^t u^T(\tau) y(\tau) d\tau$$

여기서:
- u: 입력 (전압, 힘, 토크)
- y: 출력 (전류, 속도, 각속도)
- S(x): 저장 함수 (에너지)

### 1.2 기본 원리

**물리적 직관**:
1. **에너지 보존**: 물리 시스템의 에너지 특성 활용
2. **자연스러운 제어**: 시스템의 본질적 특성 이용
3. **안정성**: 에너지 기반 안정성 보장
4. **강인성**: 매개변수 변화에 자연스럽게 강인

**주요 개념**:
- 저장 함수 (Storage Function)
- 공급률 (Supply Rate)  
- 소산성 (Dissipativity)
- 포트-해밀토니안 시스템

### 1.3 로봇 시스템의 수동성

로봇 매니퓰레이터는 본질적으로 수동적 시스템:
- **저장 함수**: 운동 에너지 + 위치 에너지
- **입력**: 관절 토크
- **출력**: 관절 속도
- **공급률**: 기계적 전력 τᵀq̇

### 1.4 역사적 발전

- **1970년대**: 네트워크 이론에서 수동성 개념 발전
- **1980년대**: Hill-Moylan의 수동성 이론 확립  
- **1990년대**: Ortega, Spong의 로봇 제어 응용
- **2000년대**: 포트-해밀토니안 시스템 이론 발달
- **현재**: 비선형 제어의 중요한 도구로 확립

## 2. 수학적 기초

### 2.1 수동성의 수학적 정의

**입출력 수동성**: 
시스템 Σ: u → y가 수동적이면, β ≥ 0이 존재하여 모든 T ≥ 0에 대해:
$$\int_0^T u^T(\tau) y(\tau) d\tau \geq -\beta$$

**상태공간 수동성**:
저장 함수 S(x) ≥ 0이 존재하여:
$$\dot{S}(x) \leq u^T y$$

**무손실 수동성 (Lossless)**: $\dot{S}(x) = u^T y$
**엄격 수동성 (Strictly Passive)**: $\dot{S}(x) \leq u^T y - \rho(y)$, ρ(y) > 0

### 2.2 KYP 보조정리 (Kalman-Yakubovich-Popov)

**선형 시스템**: $\dot{x} = Ax + Bu$, $y = Cx + Du$

**수동성 조건**: 
다음을 만족하는 P > 0이 존재:
$$\begin{bmatrix} A^T P + PA & PB - C^T \\ B^T P - C & -2D \end{bmatrix} \leq 0$$

### 2.3 포트-해밀토니안 시스템

**일반 형태**:
$$\dot{x} = [J(x) - R(x)]\frac{\partial H}{\partial x} + G(x)u$$
$$y = G^T(x)\frac{\partial H}{\partial x}$$

여기서:
- H(x): 해밀토니안 (에너지 함수)
- J(x): 왜대칭 행렬 (상호연결 구조)
- R(x): 양반정치 행렬 (소산 구조)
- G(x): 입력 행렬

**수동성**: H(x)를 저장 함수로 하여 자동으로 수동적

### 2.4 로봇 동역학의 수동성

**로봇 동역학**:
$$M(q)\ddot{q} + C(q,\dot{q})\dot{q} + G(q) = \tau$$

**포트-해밀토니안 형태**:
상태: $x = [q^T, p^T]^T$, 여기서 $p = M(q)\dot{q}$

$$\dot{x} = \begin{bmatrix} 0 & I \\ -I & -D \end{bmatrix} \frac{\partial H}{\partial x} + \begin{bmatrix} 0 \\ I \end{bmatrix} \tau$$

**해밀토니안**: $H(q,p) = \frac{1}{2}p^T M^{-1}(q) p + U(q)$

여기서 U(q)는 위치 에너지입니다.

## 3. 수동성 기반 제어 기법

### 3.1 에너지 셰이핑 (Energy Shaping)

**기본 아이디어**: 시스템의 총 에너지를 원하는 형태로 변형

**제어 목표**: 평형점 q*에서 안정화

**제어 법칙**:
$$\tau = -K_d\dot{q} + \tau_{es}$$

여기서:
- Kd > 0: 댐핑 주입
- τes: 에너지 셰이핑 항

**에너지 셰이핑 설계**:
원하는 위치 에너지 Ud(q)를 설계하여:
$$\tau_{es} = G(q) - \frac{\partial U_d}{\partial q}$$

**폐루프 에너지**: 
$$H_{cl} = \frac{1}{2}\dot{q}^T M(q)\dot{q} + U_d(q)$$

### 3.2 IDA-PBC (Interconnection and Damping Assignment)

**목표**: 원하는 포트-해밀토니안 구조 달성

**원하는 폐루프 시스템**:
$$\dot{x} = [J_d(x) - R_d(x)]\frac{\partial H_d}{\partial x}$$

**매칭 조건**:
$$[J(x) - R(x)]\frac{\partial H}{\partial x} + G(x)u = [J_d(x) - R_d(x)]\frac{\partial H_d}{\partial x}$$

**제어 법칙** (매칭 가능한 경우):
$$u = G^{-1}(x)\{[J_d(x) - R_d(x)]\frac{\partial H_d}{\partial x} - [J(x) - R(x)]\frac{\partial H}{\partial x}\}$$

### 3.3 CbI (Control by Interconnection)

**아이디어**: 제어기를 다른 수동적 시스템으로 설계

**전체 시스템**: 플랜트 + 제어기
$$\begin{bmatrix} \dot{x}_p \\ \dot{x}_c \end{bmatrix} = \begin{bmatrix} J_{pp} & J_{pc} \\ J_{cp} & J_{cc} \end{bmatrix} \begin{bmatrix} \frac{\partial H_p}{\partial x_p} \\ \frac{\partial H_c}{\partial x_c} \end{bmatrix}$$

**상호연결 행렬**: Jpc = -Jcp^T (수동성 보존)

### 3.4 댐핑 주입 (Damping Injection)

**목적**: 시스템에 인공적 댐핑 추가

**간단한 형태**:
$$\tau = -K_v\dot{q} + \tau_0$$

**적응형 댐핑**:
$$K_v = K_{v0} + \Delta K_v(\dot{q})$$

**선택적 댐핑**: 특정 방향에만 댐핑 주입

## 4. 안정성 분석

### 4.1 La Salle의 불변성 원리

**정리**: V̇ ≤ 0인 Lyapunov 함수 V에 대해, 궤적은 {x: V̇(x) = 0}의 최대 불변 집합으로 수렴

**PBC에서의 적용**: 
- V = H (해밀토니안)
- V̇ = -q̇ᵀKdq̇ ≤ 0
- 평형점에서의 수렴성 분석

### 4.2 Krasovskii-La Salle 정리

**상태 종속 댐핑**: Kd(q)인 경우의 안정성 분석

**검출가능성 조건**: 
시스템의 검출할 수 없는 모드가 안정해야 함

### 4.3 총 에너지 Lyapunov 함수

**폐루프 시스템의 총 에너지**:
$$V = \frac{1}{2}\dot{q}^T M(q)\dot{q} + \tilde{U}(q)$$

여기서 $\tilde{U}(q) = U(q) + U_d(q)$

**안정성 조건**:
1. V가 평형점에서 최소값
2. 적절한 댐핑 주입
3. 검출가능성 조건 만족

## 5. 로봇 제어 응용

### 5.1 위치 제어

**PD+ 제어기**:
$$\tau = G(q) - K_p(q - q_d) - K_v\dot{q}$$

**에너지 분석**:
- 총 에너지: $V = \frac{1}{2}\dot{q}^T M(q)\dot{q} + \frac{1}{2}(q-q_d)^T K_p(q-q_d)$
- V̇ = -q̇ᵀKvq̇ ≤ 0

### 5.2 궤적 추종

**시변 에너지 셰이핑**:
$$\tau = M(q)\ddot{q}_d + C(q,\dot{q})\dot{q}_d + G(q) - K_p e - K_v\dot{e}$$

여기서 e = q - qd(t)

### 5.3 힘 제어

**환경과의 상호작용**:
$$\tau = -K_v\dot{q} + \tau_{force}$$

**수동성 기반 안정성**: 환경이 수동적이면 전체 시스템 안정

### 5.4 유연 관절 로봇

**두 시간 척도 접근법**:
- 느린 변수: 링크 위치
- 빠른 변수: 관절 변형

**계층적 제어**: 각 부시스템별 수동성 기반 제어

## 6. 장단점 분석

### 6.1 장점

1. **물리적 직관**: 에너지 관점의 직관적 이해
2. **자연스러운 안정성**: 시스템의 본질적 특성 활용
3. **강인성**: 매개변수 변화에 자연스럽게 강인
4. **모듈성**: 수동적 시스템들의 연결도 수동적
5. **통합성**: 제어, 관측, 식별이 통일된 관점
6. **확장성**: 다양한 시스템에 적용 가능

### 6.2 단점

1. **제한된 성능**: 최적성 보장 어려움
2. **설계 복잡성**: 적절한 에너지 함수 설계 어려움
3. **제약 조건**: 매칭 조건 만족 어려움
4. **추종 성능**: 궤적 추종에서 제한된 성능
5. **실시간 구현**: 복잡한 에너지 계산

## 7. 최신 동향

### 7.1 포트-해밀토니안 네트워크

**구조 보존**: 물리 법칙을 보존하는 신경망
**학습**: 데이터로부터 해밀토니안 학습
**제어**: 학습된 구조 기반 제어 설계

### 7.2 분산 수동성 제어

**다중 에이전트**: 각 에이전트의 수동성 활용
**네트워크 수동성**: 통신 그래프의 수동성
**합의 제어**: 수동성 기반 합의 알고리즘

### 7.3 확률적 수동성

**불확실성**: 확률적 시스템의 수동성
**강인성**: 불확실성에 대한 수동성 유지
**적응성**: 매개변수 불확실성 처리

### 7.4 비홀로노믹 시스템

**제약 시스템**: 비홀로노믹 제약 하의 수동성
**이동 로봇**: 바퀴 로봇의 수동성 기반 제어
**언더액추에이티드**: 제어 입력이 부족한 시스템

## 8. 관련 텍스트북 및 참고문헌

### 주요 텍스트북

1. **Ortega, R., Loría, A., Nicklasson, P. J., & Sira-Ramírez, H. (1998)**. "Passivity-based Control of Euler-Lagrange Systems". Springer-Verlag.
   - 수동성 기반 제어의 고전적 명저
   - 라그랑주 시스템에 특화

2. **van der Schaft, A. (2017)**. "L2-Gain and Passivity Techniques in Nonlinear Control" (3rd Edition). Springer.
   - 수동성 이론의 가장 포괄적 전문서
   - 이론부터 응용까지 상세

3. **Sepulchre, R., Jankovic, M., & Kokotovic, P. V. (1997)**. "Constructive Nonlinear Control". Springer.
   - 구성적 비선형 제어 이론
   - 수동성과 백스테핑 결합

### 중요 논문들

1. **Takegaki, M., & Arimoto, S. (1981)**. "A New Feedback Method for Dynamic Control of Manipulators". ASME Journal of Dynamic Systems, Measurement, and Control.
   - PD+ 제어기의 원전
   - 에너지 기반 안정성 분석

2. **Ortega, R., & Spong, M. W. (1989)**. "Adaptive Motion Control of Rigid Robots: A Tutorial". Automatica.
   - 적응 제어와 수동성 결합
   - 로봇 제어의 중요 논문

3. **Maschke, B. M., & van der Schaft, A. J. (1992)**. "Port-controlled Hamiltonian Systems: Modelling Origins and System-theoretic Properties". IFAC Nonlinear Control Systems Design.
   - 포트-해밀토니안 시스템의 기초
   - 현대 수동성 이론의 출발점

4. **Ortega, R., van der Schaft, A., Maschke, B., & Escobar, G. (2002)**. "Interconnection and Damping Assignment Passivity-based Control of Port-controlled Hamiltonian Systems". Automatica.
   - IDA-PBC의 체계적 제시
   - 현대 PBC의 핵심 논문

### 최신 연구 동향

- **Stramigioli, S., & van der Schaft, A. (2001)**. "The Hamiltonian Formulation of Energy-conserving Physical Systems with External Ports". Archiv für Elektronik und Übertragungstechnik.

- **Duindam, V., Macchelli, A., Stramigioli, S., & Bruyninckx, H. (Eds.) (2009)**. "Modeling and Control of Complex Physical Systems: The Port-Hamiltonian Approach". Springer.

- **Rashad, R., Califano, F., van der Schaft, A. J., & Stramigioli, S. (2020)**. "Twenty Years of Distributed Port-Hamiltonian Systems: A Literature Review". IMA Journal of Mathematical Control and Information.

### 관련 분야

**기하학적 역학**: Abraham, R., & Marsden, J. E. (1978). "Foundations of Mechanics". Benjamin/Cummings.

**네트워크 이론**: Desoer, C. A., & Vidyasagar, M. (1975). "Feedback Systems: Input-Output Properties". Academic Press.

이 문서는 Ortega 등의 "Passivity-based Control of Euler-Lagrange Systems"와 van der Schaft의 "L2-Gain and Passivity Techniques in Nonlinear Control"을 주요 참고문헌으로 하여 작성되었습니다.
