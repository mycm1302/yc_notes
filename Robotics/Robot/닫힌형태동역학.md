# 닫힌형태동역학

> 상위: [[동역학]]

동역학 방정식의 각 성분을 명시적으로 계산하고 분석하는 고급 동역학 해석 방법입니다.

## 📐 기본 개념

### 정의
닫힌형태동역학(Closed Form Dynamics)은 관성행렬 M(q), 코리올리 행렬 C(q,q̇), 중력벡터 G(q)의 각 성분을 기하학적 매개변수와 운동학적 관계로부터 명시적으로 유도하는 방법입니다 [1].

### 표준 동역학 방정식
```
M(q)q̈ + C(q,q̇)q̇ + G(q) = τ
```

각 성분의 명시적 표현이 목표입니다.

## 🔗 관성행렬의 닫힌형태

### 일반적 계산법
**운동에너지로부터의 유도:**
```
T = (1/2)Σᵢ₌₁ⁿ [mᵢvᶜᵢᵀvᶜᵢ + ωᵢᵀIᵢωᵢ]
  = (1/2)q̇ᵀM(q)q̇
```

**관성행렬 성분:**
```
Mᵢⱼ = ∂²T/∂q̇ᵢ∂q̇ⱼ
```

### 직접 계산법
각 링크 k에 대한 기여도:
```
M^(k)ᵢⱼ = mₖ(∂pᶜₖ/∂qᵢ)ᵀ(∂pᶜₖ/∂qⱼ) + (∂ωₖ/∂qᵢ)ᵀIₖ(∂ωₖ/∂qⱼ)
```

여기서:
- pᶜₖ: 링크 k의 무게중심 위치
- ωₖ: 링크 k의 각속도
- Iₖ: 링크 k의 관성텐서

**전체 관성행렬:**
```
M(q) = Σₖ₌₁ⁿ M^(k)(q)
```

### 자코비안을 이용한 계산
**선속도 자코비안 Jᵛₖ:**
```
vᶜₖ = Jᵛₖ(q)q̇
```

**각속도 자코비안 Jᵂₖ:**
```
ωₖ = Jᵂₖ(q)q̇
```

**관성행렬 성분:**
```
M(q) = Σₖ₌₁ⁿ [mₖJᵛₖᵀJᵛₖ + JᵂₖᵀIₖJᵂₖ]
```

## 🌪️ 코리올리 행렬의 닫힌형태

### 크리스토펠 기호 방법
**크리스토펠 기호:**
```
Γᵢⱼₖ = (1/2)[∂Mᵢₖ/∂qⱼ + ∂Mⱼₖ/∂qᵢ - ∂Mᵢⱼ/∂qₖ]
```

**코리올리 행렬 성분:**
```
Cᵢⱼ = Σₖ₌₁ⁿ Γᵢⱼₖq̇ₖ
```

### 직접 미분법
관성행렬의 시간 미분을 이용:
```
Cᵢⱼ = (1/2)[Σₖ₌₁ⁿ (∂Mᵢⱼ/∂qₖ + ∂Mᵢₖ/∂qⱼ - ∂Mⱼₖ/∂qᵢ)q̇ₖ]
```

### 대안적 표현
**속도곱 형태:**
```
C(q,q̇)q̇ = Σᵢ Σⱼ Cᵢⱼ(q)q̇ᵢq̇ⱼ
```

**3차원 배열 표현:**
```
Cᵢⱼₖ = (1/2)[∂Mᵢₖ/∂qⱼ + ∂Mⱼₖ/∂qᵢ - ∂Mᵢⱼ/∂qₖ]
```

그러면:
```
C(q,q̇) = Σₖ₌₁ⁿ Cₖ(q)q̇ₖ
```

여기서 Cₖ(q)는 n×n 행렬

## ⚖️ 중력벡터의 닫힌형태

### 위치에너지로부터 유도
**중력 위치에너지:**
```
V = Σᵢ₌₁ⁿ mᵢgᵀpᶜᵢ(q)
```

**중력벡터:**
```
Gᵢ = ∂V/∂qᵢ = Σₖ₌₁ⁿ mₖgᵀ(∂pᶜₖ/∂qᵢ)
```

### 자코비안을 이용한 계산
```
G(q) = Σₖ₌₁ⁿ mₖJᵛₖᵀ(q)g
```

여기서 g = [0, 0, -9.81]ᵀ는 중력벡터

## 🎯 구체적 예제들

### 2링크 평면 로봇
**D-H 매개변수:**
```
링크 1: a₁ = L₁, α₁ = 0, d₁ = 0
링크 2: a₂ = L₂, α₂ = 0, d₂ = 0
```

**관성행렬:**
```
M₁₁ = I₁ + I₂ + m₂L₁² + 2m₂L₁L₂cos(θ₂)
M₁₂ = M₂₁ = I₂ + m₂L₁L₂cos(θ₂)
M₂₂ = I₂
```

**코리올리 행렬:**
```
C₁₁ = -m₂L₁L₂sin(θ₂)θ̇₂
C₁₂ = -m₂L₁L₂sin(θ₂)(θ̇₁ + θ̇₂)
C₂₁ = m₂L₁L₂sin(θ₂)θ̇₁
C₂₂ = 0
```

**중력벡터:**
```
G₁ = (m₁lc₁ + m₂L₁)g·cos(θ₁) + m₂lc₂g·cos(θ₁ + θ₂)
G₂ = m₂lc₂g·cos(θ₁ + θ₂)
```

### 3링크 스카라 로봇
**관성행렬 구조:**
수직축 회전관절로 인한 특별한 구조:
```
M = [M₁₁  M₁₂   0 ]
    [M₂₁  M₂₂   0 ]
    [ 0    0   M₃₃]
```

**중력벡터:**
수평 관절에는 중력 영향 없음:
```
G = [0, 0, (m₃ + m_payload)g]ᵀ
```

### 6자유도 매니퓰레이터
**블록 구조:**
위치와 자세가 분리된 경우:
```
M = [M_pp  M_po]
    [M_op  M_oo]
```

여기서:
- M_pp: 3×3 위치 관련
- M_oo: 3×3 자세 관련
- M_po = M_op^T: 위치-자세 커플링

## 📊 효율적 계산 방법

### 재귀적 계산
**관성행렬 계산:**
1. 말단에서 베이스로 관성 전파
2. 각 조인트에서 기여도 누적
3. 대칭성 활용하여 절반만 계산

**의사코드:**
```
for i = 1 to n:
    for j = i to n:
        M[i,j] = ComputeInertiaContribution(i,j)
        M[j,i] = M[i,j]  // 대칭성 활용
```

### 병렬 계산
**독립적 성분:**
관성행렬의 각 성분은 독립적으로 계산 가능
```
parallel for (i,j):
    M[i,j] = ComputeElement(i,j)
```

### 캐싱과 재사용
**중간 결과 저장:**
- 변환행렬들
- 자코비안 성분들
- 부분 미분값들

**점진적 업데이트:**
단일 조인트 변화 시 영향받는 성분만 재계산

## 🔍 기하학적 해석

### 관성 타원체
관성행렬의 기하학적 의미:
```
q̇ᵀM(q)q̇ = 1
```

이는 조인트 속도 공간에서 타원체를 정의

### 조작도와의 관계
작업공간 관성행렬과 연결:
```
Λ(q) = (J(q)M⁻¹(q)Jᵀ(q))⁻¹
```

### 에너지 곡면
일정 운동에너지 곡면:
```
T = (1/2)q̇ᵀM(q)q̇ = constant
```

## 🎯 응용 분야

### 실시간 제어
**계산 토크 제어:**
```
τ = M(q)(q̈d + Kd(q̇d - q̇) + Kp(qd - q)) + C(q,q̇)q̇ + G(q)
```

닫힌형태 표현으로 실시간 계산 가능

### 시뮬레이션
**순동역학:**
```
q̈ = M⁻¹(q)[τ - C(q,q̇)q̇ - G(q)]
```

### 최적화
**궤적 최적화:**
동역학 제약 조건으로 명시적 방정식 사용

### 파라미터 식별
**선형 회귀 형태:**
```
Y(q,q̇,q̈)θ = M(q)q̈ + C(q,q̇)q̇ + G(q)
```

여기서 θ는 관성 매개변수 벡터

## 🔍 수치적 고려사항

### 정확도
**부동소수점 오차:**
- 대칭성 보장을 위한 후처리
- 양정부호성 검증

### 특이점 처리
**관성행렬 역산:**
```
M⁻¹ = U Σ⁻¹ Vᵀ  (SVD 사용)
```

특이값이 작은 경우 정규화

### 조건수 개선
**좌표 스케일링:**
관절 변수들의 스케일 차이 고려

## 📚 참고문헌

[1] Lynch, K.M., & Park, F.C. (2017). *Modern Robotics: Mechanics, Planning, and Control*. Cambridge University Press.
- Chapter 8.4: Dynamic Equations in Closed Form, pp. 294-298

[2] Craig, J.J. (2017). *Introduction to Robotics: Mechanics and Control*. 4th Edition, Pearson.
- Chapter 6: Manipulator Dynamics, pp. 211-268

[3] Spong, M.W., Hutchinson, S., & Vidyasagar, M. (2020). *Robot Modeling and Control*. 2nd Edition, Wiley.
- Chapter 6: Dynamics, Section 6.2: Euler-Lagrange Equations

[4] Angeles, J. (2014). *Fundamentals of Robotic Mechanical Systems*. 4th Edition, Springer.
- Chapter 6: Dynamics of Robotic Mechanical Systems, pp. 251-302

[5] Khalil, W., & Dombre, E. (2002). *Modeling, Identification and Control of Robots*. Hermes Penton.
- Chapter 9: Inverse Dynamic Model, pp. 191-244

[6] Featherstone, R. (2008). *Rigid Body Dynamics Algorithms*. Springer.
- Chapter 9: Efficient Algorithms, pp. 189-226

[7] Walker, M.W., & Orin, D.E. (1982). "Efficient Dynamic Computer Simulation of Robotic Mechanisms". *ASME Journal of Dynamic Systems, Measurement, and Control*, 104(3), 205-211.
- 효율적 동역학 계산 알고리즘

---

## 🔗 연결 분야
- **상위**: [[동역학]]
- **관련**: [[동역학방정식성질]], [[관성특성]]
- **응용**: [[역동역학해석]], [[실시간제어]]

## 태그
#닫힌형태 #관성행렬 #크리스토펠기호 #동역학계산 #효율적알고리즘