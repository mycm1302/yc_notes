# 특수직교군

> 상위: [[선형대수및기회학]]  
> 관련: [[리군론]], [[회전표현]]

3차원 회전 변환을 다루는 특수직교군 SO(3)입니다. 로봇의 자세 제어와 방향 계획에 핵심적인 수학적 도구입니다.

## 🎯 SO(3)의 정의

### 수학적 정의
```
SO(3) = {R ∈ ℝ³ˣ³ | RRᵀ = I, det(R) = 1}

조건:
1. 직교성: RRᵀ = I (열벡터들이 정규직교)
2. 방향성: det(R) = 1 (오른손 좌표계 보존)
3. 가역성: R⁻¹ = Rᵀ
```

### 기하학적 의미
- 원점을 중심으로 하는 3차원 회전
- 거리와 각도 보존
- 강체의 방향(orientation) 표현

### 군 구조
```
곱셈: R₁R₂ (회전의 합성)
항등원: I₃ (단위행렬)
역원: R⁻¹ = Rᵀ
차원: 3 (3개의 독립적인 회전각)
```

## 🔄 다양한 표현 방법

### 1. 회전행렬 (3×3)
```
R = [r₁₁ r₁₂ r₁₃]
    [r₂₁ r₂₂ r₂₃]  ∈ SO(3)
    [r₃₁ r₃₂ r₃₃]

9개 원소, 6개 제약조건 → 3 자유도
```

### 2. 축-각도 표현
```
R = exp(θk̂)
θ ∈ [0, π]: 회전각
k ∈ S²: 단위 회전축
```

### 3. 오일러각
```
ZYX 순서: R = R_z(ψ)R_y(θ)R_x(φ)
특이점: θ = ±π/2 (김벌락)
```

### 4. 사원수 (단위 쿼터니언)
```
q = cos(θ/2) + sin(θ/2)(k₁i + k₂j + k₃k)
||q|| = 1
이중 덮개: q와 -q는 같은 회전
```

## 🧮 로드리게스 공식

### 지수 사상
```
exp: so(3) → SO(3)
exp(ω̂) = I + sin(θ)/θ ω̂ + (1-cos(θ))/θ² ω̂²

여기서:
ω̂ ∈ so(3): 반대칭 행렬
θ = ||ω||: 회전각
ω = θk: 축-각도 벡터
```

### 특수 경우
```
θ = 0: exp(ω̂) = I
θ = π: exp(ω̂) = 2kk^T - I
θ → 0: exp(ω̂) ≈ I + ω̂ (1차 근사)
```

### 로그 사상
```
log: SO(3) → so(3)
ω̂ = log(R) = θ/(2sin(θ)) (R - R^T)

θ = arccos((tr(R) - 1)/2)
```

## 🎯 so(3) 리대수

### 반대칭 행렬
```
so(3) = {ω̂ ∈ ℝ³ˣ³ | ω̂^T = -ω̂}

ω̂ = [ 0   -ω₃  ω₂ ]
    [ ω₃   0  -ω₁]
    [-ω₂  ω₁   0 ]

ω = [ω₁, ω₂, ω₃]^T ∈ ℝ³
```

### hat과 vee 연산자
```
∧: ℝ³ → so(3) (hat 연산자)
∨: so(3) → ℝ³ (vee 연산자)

ω̂ = ω∧, ω = ω̂∨
```

### 교환자 (Commutator)
```
[ω̂₁, ω̂₂] = ω̂₁ω̂₂ - ω̂₂ω̂₁ = (ω₁ × ω₂)∧

물리적 의미: 두 회전의 순서가 다를 때의 차이
```

## 🔧 실용적 연산

### 1. 회전 합성
```
총 회전: R₃ = R₁R₂
순서 중요: R₁R₂ ≠ R₂R₁ (일반적으로)
```

### 2. 상대 회전
```
R₂에서 R₁으로의 상대 회전: R₁R₂^T
```

### 3. 보간 (SLERP)
```
구면 선형 보간:
R(t) = R₁exp(t log(R₁^T R₂))
t ∈ [0,1]: R₁에서 R₂로의 최단 경로
```

### 4. 평균값
```
회전들의 평균:
R̄ = argmin_R Σᵢ ||log(R^T Rᵢ)||²
반복 알고리즘으로 해결
```

## 🤖 로봇공학 응용

### 1. 관절 회전
```
회전 관절: R_joint = exp(θᵢeᵢ∧)
θᵢ: 관절각
eᵢ: 관절축 방향
```

### 2. 순기구학
```
말단장치 방향: R_end = R₁R₂...Rₙ
연속된 회전 변환의 곱
```

### 3. 역기구학
```
목표 방향 R_target 달성:
R_error = R_target R_current^T
오차 각속도: ω_error = log(R_error)∨
```

### 4. 각속도와 각가속도
```
각속도: ω = (dR/dt)R^T ∨
각가속도: α = dω/dt + ω × ω
```

## 📊 특이점과 특성

### 1. 특이점
```
θ = π인 경우:
- 회전축이 유일하지 않음
- 수치적 불안정성
- log 사상의 불연속성
```

### 2. 주기성
```
R(θ) = R(θ + 2π)
대표 영역: θ ∈ (-π, π]
```

### 3. 이중 덮개
```
동일한 회전에 대해:
- 축-각도: (k, θ)와 (-k, -θ)
- 사원수: q와 -q
```

## 🔬 측정과 추정

### 1. 관성 측정 장치 (IMU)
```
자이로스코프: 각속도 ω 측정
가속도계: 중력 방향 추정
자기계: 자북 방향 추정

센서 융합으로 방향 추정
```

### 2. 시각적 방향 추정
```
특징점 매칭:
p'ᵢ = Rpᵢ
최소제곱법으로 R 추정
```

### 3. 칼만 필터
```
상태: ω (각속도)
측정: 방향 관련 센서들
예측: R(t+dt) = R(t)exp(ω dt)∧
```

## 🎯 수치적 고려사항

### 1. 직교성 유지
```
수치 오차로 인한 직교성 손실:
R̃ = R + ε (ε: 오차)

직교화 방법:
- 그람-슈미트 과정
- SVD: R = UΣV^T → R_ortho = UV^T
- 극분해: R = UP
```

### 2. 회전 적분
```
ω(t)가 주어졌을 때:
R(t+dt) = R(t)exp(ω(t)dt)∧

작은 각도 근사: R(t+dt) ≈ R(t)(I + ω(t)dt∧)
```

### 3. 수치적 안정성
```
θ ≈ 0 근처에서:
sin(θ)/θ ≈ 1 - θ²/6
(1-cos(θ))/θ² ≈ 1/2 - θ²/24
```

## 🚀 고급 주제

### 1. 확률적 회전
```
회전의 불확실성:
R̄ ± δR
δR는 so(3)의 분포로 표현
```

### 2. 회전 최적화
```
회전 제약 하의 최적화:
min f(R) subject to R ∈ SO(3)
매니폴드 최적화 기법 사용
```

### 3. 회전군의 토폴로지
```
SO(3) ≅ ℝP³ (실사영 3차원 공간)
기본군: π₁(SO(3)) = ℤ₂
```

## 🔧 구현 예제

### MATLAB
```matlab
% 축-각도에서 회전행렬
omega = [0.1; 0.2; 0.3];
theta = norm(omega);
k = omega/theta;
R = eye(3) + sin(theta)*skew(k) + (1-cos(theta))*skew(k)^2;

% 회전행렬에서 축-각도
theta = acos((trace(R)-1)/2);
omega_hat = theta/(2*sin(theta)) * (R - R');
omega = [omega_hat(3,2); omega_hat(1,3); omega_hat(2,1)];
```

### Python
```python
import numpy as np
from scipy.spatial.transform import Rotation as R

# 다양한 표현 간 변환
r = R.from_euler('xyz', [30, 45, 60], degrees=True)
rotation_matrix = r.as_matrix()
axis_angle = r.as_rotvec()
quaternion = r.as_quat()

# 회전 합성
r1 = R.from_euler('z', 30, degrees=True)
r2 = R.from_euler('y', 45, degrees=True)
r_combined = r1 * r2

# SLERP 보간
r_interp = R.from_matrix(rotation_matrices).mean()
```

## 🎯 학습 가이드

1. **기본 개념** (2-3주)
   - 회전행렬의 정의와 성질
   - 다양한 회전 표현법

2. **리군 구조** (3-4주)
   - so(3)과 SO(3)의 관계
   - 지수/로그 사상과 로드리게스 공식

3. **로봇 응용** (3-4주)
   - 관절 공간에서의 회전
   - 순/역 기구학에서의 활용

4. **고급 주제** (3-4주)
   - 수치적 구현과 안정성
   - 확률적 회전과 최적화

---
*참고: Modern Robotics (Lynch & Park), Robotics: Modelling, Planning and Control (Siciliano), Lie Groups for Computer Vision (Barfoot)*