# 확장칼만필터

> 상위: [[상태추정]]

비선형 시스템에서 칼만 필터를 적용하기 위해 선형화를 통해 확장한 필터입니다.

## 🎯 비선형 문제

### 기본 칼만 필터의 한계
- **선형 가정**: 실제 로봇 시스템은 대부분 비선형
- **회전 운동**: 각도, 사원수 등 비선형 상태
- **센서 모델**: 거리, 각도 측정은 비선형

### 선형화 접근법
- **1차 테일러 전개**: 현재 추정값 주변에서 선형 근사
- **야코비안 행렬**: 편미분으로 선형화
- **국소적 유효성**: 작은 오차 범위에서만 정확

## 🔄 EKF 과정

### 1. 예측 단계
```
상태 예측: x̂(k|k-1) = f(x̂(k-1|k-1), u(k))
야코비안: F(k) = ∂f/∂x|x̂(k-1|k-1)
오차 공분산 예측: P(k|k-1) = F(k)·P(k-1|k-1)·F(k)^T + Q
```

### 2. 갱신 단계
```
관측 예측: ẑ(k|k-1) = h(x̂(k|k-1))
관측 야코비안: H(k) = ∂h/∂x|x̂(k|k-1)
혁신: ν(k) = z(k) - ẑ(k|k-1)
칼만 이득: K(k) = P(k|k-1)·H(k)^T·[H(k)·P(k|k-1)·H(k)^T + R]^(-1)
상태 갱신: x̂(k|k) = x̂(k|k-1) + K(k)·ν(k)
```

## 📐 야코비안 계산

### 운동 모델 예시 (2D 로봇)
```
상태: [x, y, θ]^T
운동: x(k+1) = x(k) + v·cos(θ)·dt
      y(k+1) = y(k) + v·sin(θ)·dt  
      θ(k+1) = θ(k) + ω·dt

야코비안: F = [1  0  -v·sin(θ)·dt]
             [0  1   v·cos(θ)·dt]
             [0  0   1          ]
```

### 관측 모델 예시 (거리 센서)
```
관측: r = √[(x_l - x)² + (y_l - y)²]
야코비안: H = [(x-x_l)/r  (y-y_l)/r  0]
```

## 🤖 로봇공학 응용

### 이동 로봇 위치 추정
- **차륜형 로봇**: 비홀로노믹 제약 고려
- **GPS + IMU**: 위도/경도의 비선형 변환
- **랜드마크 기반**: 거리/각도 측정의 비선형성

### SLAM 응용
- **EKF-SLAM**: 로봇과 랜드마크 동시 추정
- **특징점 추적**: 카메라 기반 특징점 추적

### 자세 추정
- **사원수 기반**: 3D 회전의 비선형성
- **오일러각**: 짐벌 락 문제 고려

## ⚠️ 한계와 주의사항

### 선형화 오차
- **1차 근사**: 고차항 무시로 인한 오차
- **발산 가능성**: 큰 초기 오차나 모델 불일치 시
- **바이어스**: 비선형성으로 인한 추정 편향

### 계산 복잡도
- **야코비안 계산**: 매 스텝마다 편미분 계산
- **실시간 처리**: 복잡한 모델에서 계산 부담

### 개선 방법
- **UKF**: [[무향칼만필터]] - 시그마 점 사용
- **파티클 필터**: [[파티클필터]] - 샘플링 기반

## 🔗 연결 분야
- 상위: [[상태추정]]
- 기초: [[칼만필터]]
- 대안: [[무향칼만필터]], [[파티클필터]]
- 응용: [[SLAM]], [[모바일 로봇]]
- 수학: [[미분방정식]], [[선형대수]]