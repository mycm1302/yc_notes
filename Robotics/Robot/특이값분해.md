# 특이값분해

> 상위: [[선형대수및기하학]]

로봇공학에서 자코비안 분석, 의사역행렬 계산, 특이점 해석에 가장 중요한 도구인 특이값분해(SVD)입니다.

## 🔍 특이값분해의 정의

### 기본 형태
임의의 행렬 A ∈ ℝᵐˣⁿ에 대해:
```
A = UΣVᵀ

U ∈ ℝᵐˣᵐ: 좌특이벡터 행렬 (직교행렬)
Σ ∈ ℝᵐˣⁿ: 특이값 행렬 (대각성분만 존재)
V ∈ ℝⁿˣⁿ: 우특이벡터 행렬 (직교행렬)
```

### 특이값의 성질
```
σ₁ ≥ σ₂ ≥ ... ≥ σᵣ > 0 = σᵣ₊₁ = ... = σₘᵢₙ₍ₘ,ₙ₎

σᵢ: i번째 특이값
r = rank(A): 행렬의 계수
```

## 🤖 로봇공학에서의 중요성

### 1. 자코비안 분석의 핵심
로봇의 자코비안 J(q) ∈ ℝ⁶ˣⁿ에 대해:
```
J = UΣVᵀ

가조작성 지수: σₘᵢₙ/σₘₐₓ
특이점: σₘᵢₙ ≈ 0
조건수: κ(J) = σₘₐₓ/σₘᵢₙ
```

### 2. 의사역행렬 계산
```
A⁺ = VΣ⁺Uᵀ

Σ⁺ᵢᵢ = { 1/σᵢ  if σᵢ > ε
         { 0     if σᵢ ≤ ε

ε: 수치적 임계값 (보통 10⁻⁶)
```

### 3. 로봇 특이점 분류
- **σ₆ ≈ 0**: 경계 특이점 (boundary singularity)
- **σ₅ ≈ 0**: 내부 특이점 (interior singularity)  
- **여러 특이값 ≈ 0**: 복합 특이점

## 🎯 기하학적 해석

### 행렬 변환의 분해
SVD는 임의의 선형변환을 3단계로 분해:
```
1. Vᵀ: 입력공간에서의 회전
2. Σ:  주축 방향으로의 스케일링
3. U:  출력공간에서의 회전
```

### 부분공간과의 관계
```
Range(A) = span{u₁, u₂, ..., uᵣ}
Null(A)  = span{vᵣ₊₁, vᵣ₊₂, ..., vₙ}
Null(Aᵀ) = span{uᵣ₊₁, uᵣ₊₂, ..., uₘ}
Range(Aᵀ)= span{v₁, v₂, ..., vᵣ}
```

## 🔧 계산 방법

### 이론적 접근
```
AᵀA의 고유값분해: AᵀA = VΛVᵀ
AAᵀ의 고유값분해: AAᵀ = UΛUᵀ

특이값: σᵢ = √λᵢ
```

### 실용적 알고리즘

**1. Golub-Reinsch 알고리즘**
- 이중대각화 후 QR 반복
- 수치적으로 가장 안정

**2. Divide-and-Conquer**
- 큰 행렬에 효율적
- 병렬화 가능

**3. 랜덤화 알고리즘**
- 매우 큰 희소행렬에 적합
- 근사 SVD 계산

## 🚀 로봇공학 응용

### 1. 역기구학 해법
과구동 로봇 (n > 6)의 역기구학:
```
ẋ = J(q)q̇
q̇ = J⁺ẋ + (I - J⁺J)q̇₀

J⁺ = VΣ⁺Uᵀ: 의사역행렬
(I - J⁺J): 영공간 투영자
q̇₀: 부차 목적함수의 기울기
```

### 2. 특이점 회피
```
감쇠 최소제곱법 (Damped Least Squares):
J⁺_DLS = Vdiag(σᵢ/(σᵢ² + λ²))Uᵀ

λ: 감쇠 파라미터
특이점 근처에서 λ 증가
```

### 3. 가조작성 타원체
자코비안의 기하학적 해석:
```
단위구에서 타원체로의 변환:
||q̇|| = 1 → ||J(q)q̇|| = ?

반축의 길이: σᵢ
주축의 방향: vᵢ
```

## 📊 특이값의 의미

### 물리적 해석
```
σₘₐₓ: 최대 가능 말단장치 속도 비율
σₘᵢₙ: 최소 가능 말단장치 속도 비율
σᵢ/σₘₐₓ: i번째 주방향의 상대적 기여도
```

### 운동학적 해석
- **큰 특이값**: 쉽게 움직일 수 있는 방향
- **작은 특이값**: 어렵게 움직이는 방향
- **영 특이값**: 움직일 수 없는 방향 (특이점)

## 🎯 고급 기법

### 1. 부분 SVD
큰 행렬에서 일부 특이값만 계산:
```
A ≈ Uₖ Σₖ Vₖᵀ  (k << min(m,n))

처음 k개의 가장 큰 특이값만 사용
차원 축소와 노이즈 제거에 효과적
```

### 2. 증분 SVD
실시간으로 변하는 자코비안:
```
J(q) = J₀ + ΔJ
SVD 업데이트 알고리즘 사용
계산 효율성 크게 향상
```

### 3. 정규화 SVD
제약조건이 있는 경우:
```
min ||Ax - b||² + λ||x||²
해: x = (AᵀA + λI)⁻¹Aᵀb
```

## 📚 수치적 고려사항

### 안정성 문제
```
언더플로우: σᵢ < machine_epsilon
오버플로우: σᵢ > 1/machine_epsilon
스케일링을 통한 해결
```

### 임계값 설정
```
자동 임계값: ε = max(m,n) × σₘₐₓ × machine_epsilon
수동 설정: 응용에 따른 적절한 값 선택
```

### 메모리 효율성
```
Thin SVD: A = U_r Σ_r V_r^T  (r × r만 저장)
In-place 계산: 원본 행렬 덮어쓰기
```

## 🔧 구현 예제

### MATLAB
```matlab
[U, S, V] = svd(J);                    % 전체 SVD
[U, S, V] = svd(J, 'econ');           % 경제적 SVD
s = svd(J);                           % 특이값만
J_pinv = pinv(J);                     % 의사역행렬

% 감쇠 의사역행렬
lambda = 0.01;
J_dls = V * diag(diag(S)./(diag(S).^2 + lambda^2)) * U';
```

### Python (NumPy)
```python
U, s, Vt = np.linalg.svd(J, full_matrices=False)
J_pinv = np.linalg.pinv(J)

# 수동 의사역행렬 계산
threshold = 1e-6
s_inv = np.where(s > threshold, 1/s, 0)
J_pinv_manual = Vt.T @ np.diag(s_inv) @ U.T
```

### C++ (Eigen)
```cpp
Eigen::JacobiSVD<MatrixXd> svd(J, Eigen::ComputeFullU | Eigen::ComputeFullV);
MatrixXd U = svd.matrixU();
VectorXd s = svd.singularValues();
MatrixXd V = svd.matrixV();
MatrixXd J_pinv = svd.pinv();
```

## 🎯 응용 사례

### 1. 7-DOF 로봇팔
```
여분 자유도 활용:
q̇ = J⁺ẋ_desired + (I - J⁺J)∇H(q)

H(q): 부차 목적함수 (특이점 회피, 관절한계 회피 등)
```

### 2. 병렬 로봇
```
제약 자코비안 분석:
Φ(q) = 0의 자코비안 Φ_q
특이값으로 구속조건의 독립성 판단
```

### 3. 보행 로봇
```
ZMP 제약하에서의 보행:
발끝 궤적과 ZMP의 관계 분석
특이값으로 안정성 여유도 평가
```

## 🎯 학습 로드맵

1. **기초 이론** (2-3주)
   - SVD의 정의와 성질
   - 기하학적 해석

2. **로봇 응용** (3-4주)
   - 자코비안 분석과 의사역행렬
   - 특이점 분석과 회피

3. **고급 기법** (2-3주)
   - 감쇠 최소제곱법
   - 실시간 SVD 업데이트

4. **실습 프로젝트** (3-4주)
   - 여분 자유도 로봇 제어
   - 특이점 회피 알고리즘 구현

---
*참고: Matrix Computations (Golub & Van Loan), Modern Robotics (Lynch & Park), Introduction to Applied Linear Algebra (Boyd & Vandenberghe)*