# 신호조절

> 상위: [[전자회로설계]]

센서 신호의 품질 향상을 위한 증폭, 필터링, 레벨 변환 회로입니다.

## 🔍 신호 조절 목적

### 문제점 해결
- **약한 신호**: 센서 출력이 mV 단위
- **노이즈**: 전자기 간섭, 전원 잡음
- **임피던스 부정합**: 센서와 ADC 간 차이
- **레벨 부적합**: 센서 출력과 ADC 입력 범위 불일치

## 🔧 증폭 회로

### 연산증폭기 회로
```
비반전 증폭기:
이득 = 1 + R2/R1

반전 증폭기:
이득 = -R2/R1
```

### 계측증폭기 (로드셀용)
```cpp
// INA128 계측증폭기
// 이득 = 1 + 50kΩ/Rg

로드셀 설계 예시:
- 센서 출력: ±10mV
- 목표 출력: 0-3.3V
- 필요 이득: 330배
- Rg = 50kΩ/329 = 152Ω
```

### Op-Amp 선택
**추천 소자**:
- 범용: LM358, LM324
- 정밀: OPA2277, AD8628
- 저노이즈: LT1007, OP27
- 고속: LM6171, AD8099

## 🌊 필터링

### 저역통과필터 (LPF)
```
1차 RC 필터:
fc = 1/(2πRC)

2차 Sallen-Key 필터:
Q = 0.707 (Butterworth)
더 급한 롤오프 특성
```

### 실제 설계 예시
```cpp
// 로드셀 신호 필터링 (1kHz 이하 통과)
R = 1.6kΩ, C = 100nF
fc = 1/(2π × 1600 × 100×10⁻⁹) ≈ 1kHz

// IMU 가속도 필터링
R = 10kΩ, C = 10nF  
fc = 1.6kHz (진동 노이즈 제거)
```

## ⚡ 레벨 변환

### 전압 분배기
```
5V → 3.3V 변환:
R1 = 1.7kΩ (상단)
R2 = 3.3kΩ (하단)
```

### 능동 레벨 변환
```cpp
// Op-Amp 레벨 시프터
// ±10V → 0-3.3V 변환
Vref = 1.65V (중점)
이득 = 3.3V / 20V = 0.165
```

## 🔌 실제 구현 예시

### 로드셀 신호 조절 체인
```
로드셀 → 계측증폭기 → LPF → 레벨변환 → ADC
(±10mV)  (INA128)   (1kHz) (0-3.3V)  (12bit)

1. INA128: 이득 330배 → ±3.3V
2. RC 필터: fc=1kHz, 진동 노이즈 제거
3. 레벨 시프터: ±3.3V → 0-3.3V
4. ESP32 ADC: 12bit, 0.8mV/LSB 해상도
```

### IMU 신호 조절
```cpp
// MPU-9250 출력: 이미 적절한 레벨
// 3.3V 전원, 디지털 I2C 출력
// 신호 조절 불필요 → 직접 연결

// 필요시 전원 필터링만:
100nF + 10μF 디커플링 커패시터
```

## 🛡️ 노이즈 대책

### 전원 노이즈 제거
```
전원 라인:
VCC → 페라이트비드 → LC필터 → 레귤레이터
                           ↓
                     100nF + 10μF
```

### 접지 설계
```
아날로그 그라운드 ← 페라이트비드 ← 디지털 그라운드
      ↑                        ↑
   센서 회로                  MCU 회로
```

---

## 🔗 연결 문서
- 상위: [[전자회로설계]]
- 관련: [[센서인터페이스]], [[필터회로]]
- 응용: [[환경인식]], [[상태추정]], [[ADC]], [[마이크로컨트롤러]]