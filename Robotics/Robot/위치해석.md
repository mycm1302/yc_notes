# 위치해석

> 상위: [[기구학]]

기구학적 시스템에서 각 부품의 위치와 자세를 계산하는 해석 방법입니다.

## 📐 기본 개념

### 정의
위치해석(Position Analysis)은 주어진 기구학적 구조에서 입력 변수들이 주어졌을 때, 시스템 내 모든 링크와 조인트의 위치와 방향을 결정하는 과정입니다 [1].

### 수학적 기초
위치해석은 주로 다음과 같은 수학적 도구를 사용합니다:
- **벡터 기하학**: 위치 벡터와 방향 코사인
- **복소수 표현**: 2차원 평면 기구의 해석
- **동차 변환 행렬**: 3차원 공간에서의 강체 운동

## 🔄 해석 방법

### 1. 벡터 루프 방법 (Vector Loop Method)
기구의 폐쇄 루프를 벡터 방정식으로 표현하여 위치를 구하는 방법입니다 [2].

**기본 원리:**
```
Σ 위치벡터 = 0 (폐쇄 루프 조건)
```

**4절 링크의 예:**
```
r₁e^(iθ₁) + r₂e^(iθ₂) + r₃e^(iθ₃) + r₄e^(iθ₄) = 0
```

실수부와 허수부를 분리하면:
```
r₁cosθ₁ + r₂cosθ₂ + r₃cosθ₃ + r₄cosθ₄ = 0
r₁sinθ₁ + r₂sinθ₂ + r₃sinθ₃ + r₄sinθ₄ = 0
```

**해법 절차:**
1. 기구의 기하학적 구조 분석
2. 폐쇄 벡터 루프 식별  
3. 복소수 표현으로 벡터 방정식 수립
4. 실수부/허수부 분리하여 연립방정식 구성
5. 삼각함수 항등식 이용하여 해석적 해 도출

**장점:**
- 직관적이고 이해하기 쉬움
- 평면 기구에 효과적
- 해석적 해를 구할 수 있음

### 2. 동차 변환 방법 (Homogeneous Transformation)
3차원 공간에서 강체의 위치와 자세를 통합적으로 표현하는 방법입니다 [3].

**Denavit-Hartenberg (D-H) 표기법:**
각 링크를 4개의 매개변수로 표현:
- a_i: 링크 길이 (link length)
- α_i: 링크 비틀림 (link twist)  
- d_i: 링크 오프셋 (link offset)
- θ_i: 조인트 각도 (joint angle)

**변환 행렬:**
```
ᵢ⁻¹Tᵢ = [cosθᵢ    -sinθᵢcosαᵢ     sinθᵢsinαᵢ     aᵢcosθᵢ]
         [sinθᵢ     cosθᵢcosαᵢ    -cosθᵢsinαᵢ     aᵢsinθᵢ]
         [0         sinαᵢ           cosαᵢ           dᵢ      ]
         [0         0               0               1       ]
```

이는 다음 네 개의 기본 변환의 곱으로 구성됩니다 [9]:
1. z축 회전: Rot_z(θᵢ)
2. z축 병진: Trans_z(dᵢ) 
3. x축 병진: Trans_x(aᵢ)
4. x축 회전: Rot_x(αᵢ)

**순기구학 (Forward Kinematics):**
```
⁰Tₙ = ⁰T₁ · ¹T₂ · ²T₃ · ... · ⁿ⁻¹Tₙ
```

말단장치의 위치와 자세:
```
⁰Tₙ = [⁰Rₙ  ⁰pₙ]
      [0    1 ]
```

여기서 ⁰Rₙ은 회전 행렬, ⁰pₙ은 위치 벡터

**역기구학 (Inverse Kinematics):**
주어진 말단장치 위치/자세에서 조인트 변수를 구하는 문제:
- **기하학적 방법**: 삼각법과 기하학적 관계 이용
- **대수적 방법**: 변환 행렬의 역산
- **수치적 방법**: 반복 알고리즘 사용

### 3. 수치적 방법 (Numerical Methods)
복잡한 기구나 해석적 해가 존재하지 않는 경우 사용합니다 [4].

**뉴턴-랩슨 방법:**
비선형 방정식 f(q) = 0을 풀기 위한 반복 알고리즘:
```
qₖ₊₁ = qₖ - J⁻¹(qₖ)f(qₖ)
```

여기서 J는 자코비안 행렬:
```
J = ∂f/∂q
```

**알고리즘 절차:**
1. 초기값 q₀ 설정
2. 함수값 f(qₖ) 계산
3. 자코비안 J(qₖ) 계산
4. 업데이트: qₖ₊₁ = qₖ - J⁻¹f(qₖ)
5. 수렴 조건 확인: ||f(qₖ₊₁)|| < ε
6. 수렴할 때까지 반복

**수렴 조건:**
- 초기값이 해에 충분히 가까워야 함
- 자코비안이 특이(singular)하지 않아야 함
- 적절한 허용 오차 설정

**개선된 방법들:**
- **댐핑 뉴턴 방법**: qₖ₊₁ = qₖ - λJ⁻¹f(qₖ), λ ∈ (0,1]
- **의사역행렬 방법**: J⁺ = JᵀW(JJᵀW + λI)⁻¹
- **Levenberg-Marquardt**: (JᵀJ + λI)Δq = -Jᵀf

## 🎯 응용 분야

### 로봇공학
**순기구학 문제:**
6자유도 매니퓰레이터의 말단장치 위치 계산:
```
⁰p₆ = ⁰T₆[:3, 3]  # 위치 벡터 추출
⁰R₆ = ⁰T₆[:3, :3] # 자세 행렬 추출
```

**역기구학 문제:**
목표 위치 (x_d, y_d, z_d)와 자세 R_d가 주어졌을 때:
```
T_d = [R_d  p_d]
      [0    1 ]
```

조인트 각도 q = [q₁, q₂, ..., q₆]ᵀ를 구하는 문제

**작업공간 해석:**
도달 가능한 영역의 경계면 계산:
- **일차 작업공간**: 모든 자세로 도달 가능한 영역
- **이차 작업공간**: 최소 하나의 자세로 도달 가능한 영역
- **손재주 작업공간**: 충분한 조작 능력을 가진 영역

### 기계 설계
**링크 기구 해석:**
크랭크-로커 기구의 경우:
```
θ₃ = 2·arctan((B ± √(B² - 4AC))/(2A))
```

여기서:
```
A = cosθ₂ - cosθ₄
B = -2sinθ₄  
C = cosθ₄ - cosθ₂ + (r₁² + r₂² - r₃² - r₄²)/(2r₃r₄)
```

**캠 기구:**
캠 프로파일 r(φ)에 대한 종동절 변위:
```
s(φ) = ∫₀^φ r(φ')sinγ(φ')dφ'
```

**기어 기구:**
기어비 i = N₁/N₂에 따른 각속도 관계:
```
ω₂ = ω₁/i = ω₁·N₂/N₁
```

## 📊 해석 절차

### 1단계: 기구 모델링
- 조인트와 링크 정의
- 기준 좌표계 설정
- 기구학적 매개변수 결정

### 2단계: 구속 방정식 유도
- 기하학적 구속조건 설정
- 벡터 방정식 또는 좌표 방정식 유도
- 자유도와 구속조건 개수 확인

### 3단계: 방정식 해결
- 해석적 해 또는 수치적 해 계산
- 다중해 존재 시 물리적 의미 있는 해 선택
- 특이점(Singularity) 확인

### 4단계: 결과 검증
- 기하학적 일관성 확인
- 물리적 제약조건 만족 여부 검토
- 연속성과 smooth motion 확인

## 🔍 특수 고려사항

### 특이점 (Singularities)
**정의**: 자코비안 행렬의 행렬식이 0이 되는 위치
```
det(J(q)) = 0
```

**특이점의 분류:**
1. **경계 특이점 (Boundary Singularities)**: 작업공간 경계에서 발생
2. **내부 특이점 (Interior Singularities)**: 작업공간 내부에서 발생  
3. **손목 특이점 (Wrist Singularities)**: 손목 축들이 평행할 때

**6R 매니퓰레이터의 특이점 조건:**
- **어깨 특이점**: det(J₁₋₃) = 0 (위치 자코비안)
- **팔꿈치 특이점**: 팔꿈치가 완전히 펴지거나 접힐 때
- **손목 특이점**: det(J₄₋₆) = 0 (자세 자코비안)

**영향**: 
- 무한한 속도 요구
- 제어 불가능한 운동 방향 존재
- 수치적 불안정성

**대책**: 
- 특이점 회피 궤적 계획
- 댐핑 최소제곱법 (Damped Least Squares)
- 여유 자유도 활용

### 다중해 (Multiple Solutions)
**원인**: 비선형 기구학 방정식의 특성

**6R 매니퓰레이터의 해의 개수:**
- 일반적으로 최대 16개의 실근 존재
- 구면 손목의 경우 8개의 해로 감소
- Pieper의 해법으로 해석적 해 도출 가능

**분류 방법:**
1. **팔꿈치 위/아래 (Elbow Up/Down)**
2. **어깨 앞/뒤 (Shoulder Left/Right)**  
3. **손목 뒤집힌/정상 (Wrist Flip/No Flip)**

**해 선택 기준:**
- 이전 자세와의 연속성 (최소 조인트 이동)
- 조인트 한계 회피
- 특이점 회피
- 에너지 최소화

### 수치적 안정성
**조건수 (Condition Number):**
```
κ(J) = σₘₐₓ(J)/σₘᵢₙ(J)
```

여기서 σ는 특이값(singular value)

**개선 방법:**
1. **스케일링**: 조인트 변수의 정규화
2. **정규화**: λI 항 추가로 조건수 개선  
3. **SVD 분해**: 특이값 분해를 통한 안정적 역산

**허용 오차 설정:**
- 위치 오차: ||Δp|| < εₚ (일반적으로 0.1mm)
- 자세 오차: ||Δω|| < εᵣ (일반적으로 0.1°)
- 최대 반복 횟수: N_max (일반적으로 100회)

## 📚 참고문헌

[1] Craig, J.J. (2017). *Introduction to Robotics: Mechanics and Control*. 4th Edition, Pearson Education. ISBN: 978-0133489798.
- Chapter 3: Forward Kinematics, pp. 71-108
- Chapter 4: Inverse Kinematics, pp. 109-164

[2] Norton, R.L. (2019). *Design of Machinery: An Introduction to the Synthesis and Analysis of Mechanisms and Machines*. 6th Edition, McGraw-Hill Education. ISBN: 978-0077421717.
- Chapter 4: Position Analysis, pp. 152-201
- Chapter 7: Analytical Linkage Synthesis, pp. 287-334

[3] Spong, M.W., Hutchinson, S., & Vidyasagar, M. (2020). *Robot Modeling and Control*. 2nd Edition, John Wiley & Sons. ISBN: 978-1118524305.
- Chapter 3: Forward Kinematics, pp. 63-108
- Chapter 4: Inverse Kinematics, pp. 109-156

[4] Siciliano, B., Sciavicco, L., Villani, L., & Oriolo, G. (2010). *Robotics: Modelling, Planning and Control*. 2nd Edition, Springer. ISBN: 978-1846286414.
- Chapter 2: Direct Kinematics, pp. 55-110
- Chapter 4: Inverse Kinematics, pp. 165-214

[5] Angeles, J. (2014). *Fundamentals of Robotic Mechanical Systems: Theory, Methods, and Algorithms*. 4th Edition, Springer. ISBN: 978-3319018508.
- Chapter 4: Kinetostatic Performance Indices, pp. 145-198
- Chapter 6: Trajectory Planning, pp. 251-302

[6] Lynch, K.M., & Park, F.C. (2017). *Modern Robotics: Mechanics, Planning, and Control*. Cambridge University Press. ISBN: 978-1107156302.
- Chapter 3: Rigid-Body Motions, pp. 67-102
- Chapter 4: Forward Kinematics, pp. 103-138

[7] Paul, R.P. (1981). *Robot Manipulators: Mathematics, Programming, and Control*. MIT Press. ISBN: 978-0262161329.
- Chapter 2: Spatial Description and Transformations, pp. 9-44
- Chapter 3: Manipulator Kinematics, pp. 45-78

[8] Pieper, D.L. (1968). *The Kinematics of Manipulators Under Computer Control*. PhD Thesis, Stanford University.
- 원저: 구면 손목을 가진 6R 매니퓰레이터의 해석적 역기구학 해법

[9] Denavit, J., & Hartenberg, R.S. (1955). "A Kinematic Notation for Lower-Pair Mechanisms Based on Matrices". *Journal of Applied Mechanics*, 22(2), 215-221.
- D-H 표기법의 원저 논문
- URL: https://en.wikipedia.org/wiki/Denavit–Hartenberg_parameters (참조 가능)

[10] Wampler, C.W. (1996). "Forward Displacement Analysis of General Six-in-Parallel SPS (Stewart) Platform Manipulators Using Soma Coordinates". *Mechanism and Machine Theory*, 31(3), 331-337.
- 병렬 기구의 순기구학 해석

[11] Automatic Addison (2020). "Homogeneous Transformation Matrices Using Denavit-Hartenberg".
- URL: https://automaticaddison.com/homogeneous-transformation-matrices-using-denavit-hartenberg/
- 현대적 D-H 변환 행렬 계산법

[12] Robot Academy. "Denavit-Hartenberg Notation".
- URL: https://robotacademy.net.au/lesson/denavit-hartenberg-notation/
- D-H 표기법의 실용적 설명 및 구현

[13] Universal Robots (2025). "DH Parameters for Calculations of Kinematics and Dynamics".
- URL: https://www.universal-robots.com/articles/ur/application-installation/dh-parameters-for-calculations-of-kinematics-and-dynamics/
- 산업용 로봇의 실제 D-H 매개변수 적용 사례

---

## 🔗 연결 분야
- **상위**: [[운동해석]]
- **관련**: [[속도해석]], [[가속도해석]], [[기구학]]
- **도구**: [[ADAMS]], [[RecurDyn]], [[SimMechanics]]

## 태그
#위치해석 #기구학 #벡터루프 #동차변환 #순기구학 #역기구학