# Feedback Linearization (피드백 선형화)

## 1. 개요 및 배경

Feedback Linearization은 비선형 시스템을 적절한 피드백과 좌표 변환을 통해 선형 시스템으로 변환하는 제어 기법입니다. 1980년대 미분 기하학적 제어 이론의 발전과 함께 Isidori, Nijmeijer, Hunt 등에 의해 체계화되었으며, 로봇 제어에서 비선형성을 근본적으로 해결하는 강력한 도구입니다.

### 1.1 기본 개념

피드백 선형화의 핵심 아이디어:
1. **좌표 변환**: 비선형 좌표를 선형 좌표로 변환
2. **상태 피드백**: 비선형 피드백을 통한 선형화
3. **입출력 선형화**: 입출력 관계의 선형화
4. **정확한 선형화**: 근사가 아닌 정확한 변환

### 1.2 미분 기하학적 기초

**벡터장 (Vector Field)**: 
$$f(x) = \begin{bmatrix} f_1(x) \\ \vdots \\ f_n(x) \end{bmatrix}$$

**Lie 미분**: 
스칼라 함수 h(x)에 대한 벡터장 f의 Lie 미분:
$$L_f h(x) = \frac{\partial h}{\partial x} f(x) = \nabla h^T f$$

**Lie 괄호 (Lie Bracket)**:
$$[f, g](x) = \frac{\partial g}{\partial x} f(x) - \frac{\partial f}{\partial x} g(x)$$

### 1.3 적용 가능성

**입출력 선형화**: 거의 모든 시스템에 적용 가능 (상대차수 조건)
**완전 상태 선형화**: 제한된 시스템 클래스 (적분 가능성 조건)

### 1.4 로봇 제어에서의 중요성

- **비선형성 제거**: 로봇의 복잡한 비선형 동역학 완전 제거
- **결합 해제**: 관절 간 동역학적 결합 완전 분리  
- **선형 제어 이론 활용**: 확립된 선형 제어 기법 직접 적용
- **성능 보장**: 이론적으로 완벽한 추종 성능

## 2. 수학적 기초

### 2.1 비선형 시스템 모델

**일반 형태**:
$$\dot{x} = f(x) + g(x)u$$
$$y = h(x)$$

여기서:
- x ∈ ℝⁿ: 상태 벡터
- u ∈ ℝᵐ: 제어 입력
- y ∈ ℝᵖ: 출력
- f(x), g(x), h(x): 매끄러운 함수

### 2.2 상대차수 (Relative Degree)

**정의**: 출력 y가 입력 u에 직접적으로 영향을 받기까지의 미분 횟수

**수학적 정의**: 
출력 yᵢ의 상대차수 rᵢ는 다음을 만족하는 최소 정수:
$$L_{g_j} L_f^{k} h_i(x) = 0, \quad \forall j, \quad 0 \leq k < r_i - 1$$
$$L_{g_j} L_f^{r_i-1} h_i(x) \neq 0, \quad \text{적어도 하나의 } j$$

**총 상대차수**: $r = r_1 + \cdots + r_p$

### 2.3 정규 형태 (Normal Form)

상대차수를 이용한 좌표 변환:
$$\xi_{i,j} = L_f^{j-1} h_i(x), \quad j = 1, \ldots, r_i$$

**변환된 시스템**:
$$\dot{\xi}_{i,j} = \xi_{i,j+1}, \quad j = 1, \ldots, r_i - 1$$
$$\dot{\xi}_{i,r_i} = L_f^{r_i} h_i(x) + \sum_{j=1}^m L_{g_j} L_f^{r_i-1} h_i(x) u_j$$

**영동역학 (Zero Dynamics)**: r < n인 경우의 내부 동역학
$$\dot{\eta} = q(η, 0)$$

### 2.4 가역성 조건

**디커플링 행렬**: 
$$D(x) = \begin{bmatrix} L_{g_1} L_f^{r_1-1} h_1(x) & \cdots & L_{g_m} L_f^{r_1-1} h_1(x) \\ \vdots & \ddots & \vdots \\ L_{g_1} L_f^{r_p-1} h_p(x) & \cdots & L_{g_m} L_f^{r_p-1} h_p(x) \end{bmatrix}$$

**조건**: D(x)가 가역이어야 함 (det D(x) ≠ 0)

## 3. 입출력 선형화

### 3.1 제어 법칙

**선형화 제어**:
$$u = D^{-1}(x)[v - a(x)]$$

여기서:
- $a(x) = [L_f^{r_1} h_1(x), \ldots, L_f^{r_p} h_p(x)]^T$
- v: 새로운 제어 입력

**선형화된 시스템**:
$$\frac{d^{r_i}}{dt^{r_i}} y_i = v_i, \quad i = 1, \ldots, p$$

### 3.2 외부 루프 설계

각 출력 채널에 대해 독립적으로 선형 제어기 설계:
$$v_i = y_d^{(r_i)} + k_{r_i-1}(y_d^{(r_i-1)} - y^{(r_i-1)}) + \cdots + k_0(y_d - y)$$

**특성 방정식**: $s^{r_i} + k_{r_i-1}s^{r_i-1} + \cdots + k_0 = 0$

극점 배치를 통한 성능 조정

### 3.3 영동역학 안정성

**최소위상 시스템**: 영동역학이 안정한 시스템
- 입출력 선형화 안전하게 적용 가능
- 내부 안정성 보장

**비최소위상 시스템**: 영동역학이 불안정
- 입출력 선형화 위험
- 대안적 접근법 필요

## 4. 완전 상태 선형화

### 4.1 적분 가능성 조건

**Frobenius 정리**: 분포 Δ가 적분 가능하려면 대합적이어야 함
$$[X, Y] \in \Δ, \quad \forall X, Y \in \Δ$$

**벡터장 분포**:
$$\Δ = \text{span}\{g_1(x), \ldots, g_m(x), \text{ad}_f g_1(x), \ldots\}$$

여기서 $\text{ad}_f g = [f, g]$는 Lie 괄호입니다.

### 4.2 Chow의 정리

**제어 가능성**: 분포 Δ가 전체 공간을 생성하면 시스템은 제어 가능

**차원 조건**: dim Δ = n

### 4.3 완전 선형화 제어

**좌표 변환**: z = Φ(x)
**제어 변환**: u = α(x) + β(x)v

**선형화된 시스템**:
$$\dot{z} = Az + Bv$$

여기서 (A, B)는 제어 표준형입니다.

## 5. 로봇 제어 적용

### 5.1 로봇 매니퓰레이터

**로봇 동역학**:
$$M(q)\ddot{q} + C(q,\dot{q})\dot{q} + G(q) = \tau$$

**상태 공간 형태**:
$$\begin{bmatrix} \dot{q} \\ \ddot{q} \end{bmatrix} = \begin{bmatrix} \dot{q} \\ M^{-1}(q)[\tau - C(q,\dot{q})\dot{q} - G(q)] \end{bmatrix}$$

**출력**: y = q (관절 위치)

**상대차수**: 각 출력에 대해 r = 2 (이중 적분기)

### 5.2 관절 공간 제어

**선형화 제어 법칙**:
$$\tau = M(q)v + C(q,\dot{q})\dot{q} + G(q)$$

**선형화된 시스템**:
$$\ddot{q} = v$$

**외부 루프**: 각 관절에 대해 독립적 PD 제어
$$v_i = \ddot{q}_{d,i} + k_{d,i}(\dot{q}_{d,i} - \dot{q}_i) + k_{p,i}(q_{d,i} - q_i)$$

**결과**: 계산된 토크 제어와 동일!

### 5.3 작업 공간 제어

**작업 공간 동역학**:
$$\Lambda(x)\ddot{x} + \mu(x,\dot{x})\dot{x} + p(x) = F$$

여기서:
- $\Lambda(x) = (J^T M^{-1} J)^{-1}$: 작업 공간 관성 행렬
- $\mu(x,\dot{x}) = \Lambda J^T M^{-1} C - \Lambda \dot{J}$
- $p(x) = \Lambda J^T M^{-1} G$
- $F = \Lambda J^T M^{-1} \tau$

**직접 작업 공간 제어**:
$$F = \Lambda(x)w + \mu(x,\dot{x})\dot{x} + p(x)$$

**선형화**: $\ddot{x} = w$

### 5.4 특이점 문제

**운동학적 특이점**: det J(q) = 0

**문제점**: 
- 무한대 토크 필요
- 제어 불가능한 방향 존재

**해결 방법**:
- 특이점 회피 경로 계획
- 댐핑된 최소자승법
- 작업 공간 분해

## 6. 안정성 분석

### 6.1 영동역학 안정성

**로봇 시스템의 영동역학**: 
n자유도 로봇에서 p < n인 출력에 대해 (n-p)차 영동역학 존재

**위치 제어**: 출력 y = q인 경우
- 상대차수: r = 2n (모든 자유도)
- 영동역학: 없음 (완전 선형화)

**부분 궤적 추종**: 일부 자유도만 제어하는 경우
- 내부 동역학 안정성 분석 필요
- 제어되지 않는 자유도의 거동

### 6.2 국소 안정성

**선형화 점 주변**: 자코비안 행렬의 고유값 분석

**Lyapunov 첫 번째 방법**: 
선형화된 시스템의 안정성으로 원시스템 판단

### 6.3 전역 안정성

**Lyapunov 함수**: 
에너지 기반 함수 구성
$$V = \frac{1}{2}\dot{q}^T M(q)\dot{q} + \frac{1}{2}e^T K_p e$$

**안정성 조건**:
- Kp, Kd > 0
- 검출가능성 조건

### 6.4 강인성 분석

**모델링 오차**: 
실제 시스템과 모델 간 차이로 인한 영향

**불확실성 영향**:
- 완전 선형화 불가능
- 잔여 비선형성 존재
- 성능 저하 가능

**강인화 방법**:
- 적응 제어 결합
- 슬라이딩 모드 추가
- H∞ 제어 결합

## 7. 확장과 변형

### 7.1 적응형 피드백 선형화

**매개변수 불확실성**: 로봇 매개변수 미지

**적응 법칙**:
$$\dot{\hat{\theta}} = \Gamma Y^T(q,\dot{q},\dot{q}_r,\ddot{q}_r) s$$

**제어 법칙**:
$$\tau = Y(q,\dot{q},\dot{q}_r,\ddot{q}_r)\hat{\theta}$$

### 7.2 강인 피드백 선형화

**슬라이딩 모드 결합**:
$$\tau = \hat{M}(q)v + \hat{C}(q,\dot{q})\dot{q} + \hat{G}(q) - K \text{sgn}(s)$$

**H∞ 설계**: 불확실성에 대한 강인성 향상

### 7.3 출력 재정의

**새로운 출력**: ỹ = h̃(x)
- 상대차수 조정
- 영동역학 안정화
- 성능 향상

## 8. 장단점 분석

### 8.1 장점

1. **정확한 선형화**: 근사가 아닌 정확한 변환
2. **결합 해제**: 관절 간 완전한 분리
3. **성능 보장**: 이론적으로 완벽한 추종
4. **설계 체계성**: 수학적으로 엄밀한 방법론
5. **선형 이론 활용**: 확립된 선형 제어 기법 적용
6. **다변수 시스템**: MIMO 시스템에 자연스럽게 적용

### 8.2 단점

1. **모델 의존성**: 정확한 모델 필수
2. **계산 복잡성**: 실시간 역행렬 계산
3. **특이점 문제**: 자코비안 특이점에서 실패
4. **강인성 제한**: 모델 오차에 민감
5. **영동역학**: 내부 동역학 불안정 가능성
6. **실용성**: 이론과 실제 간 격차

## 9. 최신 동향

### 9.1 학습 기반 선형화
- 신경망을 이용한 역동역학 학습
- 데이터 기반 모델 식별
- 온라인 적응 및 보상

### 9.2 부분 피드백 선형화
- 일부 방향만 선형화
- 영동역학 최소화
- 계산 부담 감소

### 9.3 분산 피드백 선형화
- 대규모 시스템 분해
- 분산 계산 구조
- 통신 지연 고려

### 9.4 확률적 선형화
- 불확실성을 고려한 선형화
- 확률적 안정성 보장
- 베이지안 접근법

## 10. 관련 텍스트북 및 참고문헌

### 주요 텍스트북

1. **Isidori, A. (1995)**. "Nonlinear Control Systems" (3rd Edition). Springer-Verlag.
   - 피드백 선형화의 고전적 명저
   - 미분 기하학적 제어 이론의 기초

2. **Nijmeijer, H., & van der Schaft, A. (1990)**. "Nonlinear Dynamical Control Systems". Springer-Verlag.
   - 체계적인 미분 기하학적 접근
   - 이론적 기초부터 응용까지

3. **Khalil, H. K. (2002)**. "Nonlinear Systems" (3rd Edition). Prentice Hall.
   - 실용적 관점의 피드백 선형화
   - 안정성 분석 포함

4. **Slotine, J.-J. E., & Li, W. (1991)**. "Applied Nonlinear Control". Prentice Hall.
   - 로봇 제어 응용에 중점
   - 실제 구현 고려사항

### 중요 논문들

1. **Hunt, L. R., Su, R., & Meyer, G. (1983)**. "Global Transformations of Nonlinear Systems". IEEE Transactions on Automatic Control.
   - 전역 피드백 선형화의 기초
   - 적분 가능성 조건 확립

2. **Isidori, A., & Ruberti, A. (1984)**. "On the Synthesis of Linear Input-Output Maps for Nonlinear Systems". Systems & Control Letters.
   - 입출력 선형화 이론
   - 영동역학 개념 도입

3. **Spong, M. W. (1987)**. "Modeling and Control of Elastic Joint Robots". ASME Journal of Dynamic Systems, Measurement, and Control.
   - 유연 관절 로봇의 피드백 선형화
   - 비최소위상 시스템 다룸

4. **De Luca, A., Mattone, R., & Oriolo, G. (2000)**. "Stabilization of an Underactuated Planar 2R Manipulator". International Journal of Robust and Nonlinear Control.
   - 언더액추에이티드 시스템
   - 부분 피드백 선형화

### 로봇 응용 논문들

- **Takegaki, M., & Arimoto, S. (1981)**. "A New Feedback Method for Dynamic Control of Manipulators". ASME Journal of Dynamic Systems, Measurement, and Control.

- **Freund, E. (1982)**. "Fast Nonlinear Control with Arbitrary Pole-Placement for Industrial Robots and Manipulators". International Journal of Robotics Research.

- **Paul, R. P. (1981)**. "Robot Manipulators: Mathematics, Programming, and Control". MIT Press.

### 최신 연구 동향

- **Siciliano, B., & Khatib, O. (Eds.) (2016)**. "Springer Handbook of Robotics" (2nd Edition). Springer.

- **Lynch, K. M., & Park, F. C. (2017)**. "Modern Robotics: Mechanics, Planning, and Control". Cambridge University Press.

- **Bullo, F., & Lewis, A. D. (2005)**. "Geometric Control of Mechanical Systems". Springer.

### 미분 기하학 기초

**수학적 배경**:
- **Abraham, R., Marsden, J. E., & Ratiu, T. (1988)**. "Manifolds, Tensor Analysis, and Applications". Springer-Verlag.
- **Boothby, W. M. (2003)**. "An Introduction to Differentiable Manifolds and Riemannian Geometry". Academic Press.

이 문서는 Isidori의 "Nonlinear Control Systems"와 Nijmeijer & van der Schaft의 "Nonlinear Dynamical Control Systems"를 주요 참고문헌으로 하여 작성되었습니다.
