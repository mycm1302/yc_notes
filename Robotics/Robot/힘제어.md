# Force Control (힘 제어)

## 1. 개요 및 배경

Force Control은 로봇이 환경과 접촉하는 작업에서 원하는 힘을 정확히 제어하는 기법입니다. 1970년대 후반부터 연구되기 시작하여, Mason의 하이브리드 위치/힘 제어(1981), Raibert과 Craig의 하이브리드 제어(1981) 등이 기초를 마련했습니다.

### 1.1 기본 개념

힘 제어의 핵심 아이디어:
1. **직접 힘 제어**: 힘 센서를 이용한 직접적 힘 피드백
2. **제약 조건**: 환경에 의해 부과되는 기하학적/물리적 제약
3. **이중성**: 위치와 힘의 상호 보완적 관계
4. **접촉 안정성**: 환경과의 안정적 상호작용

### 1.2 접촉 역학

**접촉 모델**:
- 점 접촉 (Point Contact)
- 선 접촉 (Line Contact)  
- 면 접촉 (Surface Contact)

**마찰 모델**:
- 쿨롱 마찰
- 점성 마찰
- 스틱-슬립 현상

### 1.3 응용 분야

**산업 응용**:
- 조립 작업 (삽입, 체결)
- 가공 작업 (연마, 디버링)
- 용접 및 접착
- 품질 검사

**서비스 응용**:
- 의료 로봇 (수술, 재활)
- 가정용 로봇
- 인간-로봇 상호작용
- 원격 조작

### 1.4 역사적 발전

- **1970년대**: 초기 힘 제어 연구 시작
- **1981년**: Mason의 하이브리드 제어 이론
- **1980년대**: 다양한 힘 제어 기법 개발
- **1990년대**: 적응형 및 지능형 힘 제어
- **2000년대 이후**: 센서 기술 발달과 실용화

## 2. 수학적 기초

### 2.1 접촉 기하학

**접촉 프레임**:
접촉점에서 정의된 좌표계
- n: 법선 방향 (접촉면에 수직)
- t₁, t₂: 접선 방향 (접촉면에 평행)

**접촉 변환**:
$$\mathbf{F}_c = \mathbf{R}_c^T \mathbf{F}_e$$

여기서:
- **Fc**: 접촉 프레임에서의 힘
- **Fe**: 엔드 이펙터 프레임에서의 힘
- **Rc**: 회전 변환 행렬

### 2.2 제약 조건

**홀로노믹 제약**:
$$\boldsymbol{\phi}(\mathbf{x}) = \mathbf{0}$$

**비홀로노믹 제약**:
$$\mathbf{A}(\mathbf{x})\dot{\mathbf{x}} = \mathbf{0}$$

**가상 일의 원리**:
$$\delta\mathbf{x}^T \mathbf{F} + \delta\mathbf{x}^T \boldsymbol{\lambda}^T \frac{\partial\boldsymbol{\phi}}{\partial\mathbf{x}} = 0$$

여기서 λ는 라그랑주 승수입니다.

### 2.3 Mason의 하이브리드 제어

**기본 아이디어**: 각 방향에서 위치 또는 힘 중 하나만 독립적으로 제어 가능

**선택 행렬 S**:
- Sᵢᵢ = 1: 힘 제어 방향
- Sᵢᵢ = 0: 위치 제어 방향

**제어 법칙**:
$$\mathbf{F} = \mathbf{S}[\mathbf{F}_d + \mathbf{K}_f(\mathbf{F}_d - \mathbf{F}_e)] + (\mathbf{I} - \mathbf{S})\mathbf{F}_{\text{pos}}$$

여기서:
- **Fd**: 원하는 힘
- **Kf**: 힘 제어 이득
- **Fpos**: 위치 제어로부터의 힘

### 2.4 직접 힘 제어

**비례-적분 힘 제어**:
$$\mathbf{u}_f = \mathbf{K}_p(\mathbf{F}_d - \mathbf{F}_e) + \mathbf{K}_i\int_0^t (\mathbf{F}_d - \mathbf{F}_e) d\tau$$

**위치 기반 힘 제어**:
$$\mathbf{x}_d = \mathbf{x}_{d0} + \mathbf{K}_f^{-1}(\mathbf{F}_d - \mathbf{F}_e)$$

### 2.5 간접 힘 제어

환경의 강성을 이용한 간접적 힘 제어:
$$\mathbf{F}_e = \mathbf{K}_e(\mathbf{x} - \mathbf{x}_e)$$

**제어 법칙**:
$$\mathbf{x}_d = \mathbf{x}_e + \mathbf{K}_e^{-1}\mathbf{F}_d$$

**장점**: 힘 센서 불필요
**단점**: 환경 강성 정보 필요

## 3. 힘 제어 기법들

### 3.1 병렬 위치/힘 제어

위치 제어기와 힘 제어기를 병렬로 구성:
$$\boldsymbol{\tau} = \boldsymbol{\tau}_{\text{pos}} + \boldsymbol{\tau}_{\text{force}}$$

**위치 제어기**:
$$\boldsymbol{\tau}_{\text{pos}} = \mathbf{J}^T(\mathbf{I} - \mathbf{S})\mathbf{F}_{\text{pos}}$$

**힘 제어기**:
$$\boldsymbol{\tau}_{\text{force}} = \mathbf{J}^T\mathbf{S}\mathbf{K}_f(\mathbf{F}_d - \mathbf{F}_e)$$

### 3.2 직교 분해 제어

작업 공간을 위치 부공간과 힘 부공간으로 직교 분해:

**직교 행렬**:
$$\mathbf{E}_f^\perp \mathbf{E}_f = \mathbf{0}, \quad \mathbf{E}_f^\perp \mathbf{E}_f^\perp + \mathbf{E}_f \mathbf{E}_f = \mathbf{I}$$

**제어 법칙**:
$$\mathbf{F} = \mathbf{E}_f \mathbf{u}_f + \mathbf{E}_f^\perp \mathbf{u}_p$$

### 3.3 적응형 힘 제어

환경 매개변수의 불확실성을 다루는 적응형 접근:

**환경 모델**:
$$\mathbf{F}_e = \mathbf{K}_e(\mathbf{x} - \mathbf{x}_e) + \mathbf{B}_e\dot{\mathbf{x}}$$

**적응 법칙**:
$$\dot{\hat{\mathbf{K}}}_e = \boldsymbol{\Gamma}_K (\mathbf{x} - \mathbf{x}_e) e_f^T$$
$$\dot{\hat{\mathbf{B}}}_e = \boldsymbol{\Gamma}_B \dot{\mathbf{x}} e_f^T$$

여기서 ef = Fd - Fe는 힘 오차입니다.

## 4. 안정성 분석

### 4.1 접촉 안정성

**환경-로봇 시스템**:
$$\mathbf{M}_r\ddot{\mathbf{x}} + \mathbf{B}_r\dot{\mathbf{x}} + \mathbf{K}_r\mathbf{x} = \mathbf{F}_e$$
$$\mathbf{F}_e = \mathbf{K}_e(\mathbf{x} - \mathbf{x}_e) + \mathbf{B}_e\dot{\mathbf{x}}$$

**결합 시스템**:
$$\mathbf{M}_r\ddot{\mathbf{x}} + (\mathbf{B}_r + \mathbf{B}_e)\dot{\mathbf{x}} + (\mathbf{K}_r + \mathbf{K}_e)\mathbf{x} = \mathbf{K}_e\mathbf{x}_e$$

**안정성 조건**:
- **Mr** > 0
- **Br** + **Be** > 0  
- **Kr** + **Ke** > 0

### 4.2 수동성 기반 접근

**수동성 정리**: 로봇과 환경이 모두 수동적이면 결합 시스템 안정

**로봇의 수동성**:
$$\int_0^T \mathbf{F}_e^T\dot{\mathbf{x}} \, dt \geq -\beta_r$$

**환경의 수동성**:
$$\int_0^T \mathbf{F}_e^T\dot{\mathbf{x}} \, dt \leq \beta_e$$

### 4.3 Lyapunov 안정성

**에너지 함수**:
$$V = \frac{1}{2}\dot{\mathbf{x}}^T\mathbf{M}_r\dot{\mathbf{x}} + \frac{1}{2}(\mathbf{x} - \mathbf{x}_e)^T\mathbf{K}_e(\mathbf{x} - \mathbf{x}_e)$$

**안정성 증명**: V̇ ≤ 0 조건 확인

## 5. 센서 기술

### 5.1 힘/토크 센서

**6축 F/T 센서**:
- 3축 힘 (Fx, Fy, Fz)
- 3축 토크 (Mx, My, Mz)

**센서 사양**:
- 분해능: 0.01-0.1 N
- 정확도: ±0.1-1% FS
- 샘플링 주파수: 1-10 kHz

**장착 위치**:
- 손목형 (Wrist-mounted)
- 베이스형 (Base-mounted)
- 내장형 (Built-in)

### 5.2 촉각 센서

**저항형 센서**: 압력에 따른 저항 변화
**용량형 센서**: 변형에 따른 용량 변화
**압전형 센서**: 동적 힘 측정에 적합

### 5.3 시각 기반 힘 추정

**원리**: 변형 관찰을 통한 힘 추정
$$\mathbf{F} = \mathbf{K}_{\text{visual}} \cdot \Delta\mathbf{x}_{\text{visual}}$$

**장점**: 비접촉 측정, 다점 측정
**단점**: 조명 조건 민감, 계산 복잡

## 6. 구현 고려사항

### 6.1 센서 노이즈 처리

**칼만 필터**:
$$\hat{\mathbf{F}}_{k|k} = \hat{\mathbf{F}}_{k|k-1} + \mathbf{K}_k(\mathbf{F}_k - \mathbf{H}\hat{\mathbf{F}}_{k|k-1})$$

**저역 통과 필터**:
$$\mathbf{F}_{\text{filtered}} = \alpha \mathbf{F}_{\text{raw}} + (1-\alpha) \mathbf{F}_{\text{prev}}$$

### 6.2 영점 조정 (Bias Compensation)

센서 드리프트와 중력 보상:
$$\mathbf{F}_{\text{compensated}} = \mathbf{F}_{\text{raw}} - \mathbf{F}_{\text{bias}} - \mathbf{F}_{\text{gravity}}$$

### 6.3 실시간 성능

**제어 주기**: 1-10 ms
**센서 지연**: 최소화 필요
**계산 최적화**: 효율적 알고리즘 사용

## 7. 응용 사례

### 7.1 조립 작업

**Peg-in-hole 삽입**:
- 법선 방향: 힘 제어 (일정한 삽입력)
- 접선 방향: 위치 제어 (정렬 유지)

**나사 체결**:
- 회전 방향: 토크 제어
- 축 방향: 힘 제어

### 7.2 가공 작업

**연마 (Grinding)**:
- 법선 힘: 일정하게 유지
- 이송 속도: 표면 품질에 따라 조정

**디버링 (Deburring)**:
- 적응적 힘 제어
- 버(Burr) 크기에 따른 힘 조정

### 7.3 검사 작업

**표면 검사**: 촉각 정보를 통한 결함 검출
**강성 측정**: 변형-힘 관계 분석

## 8. 장단점 분석

### 8.1 장점

1. **직접 제어**: 힘을 직접 측정하고 제어
2. **정밀성**: 높은 힘 제어 정확도
3. **안전성**: 과도한 힘 방지
4. **다양성**: 다양한 접촉 작업에 적용
5. **품질 향상**: 일정한 가공 조건 유지

### 8.2 단점

1. **센서 의존성**: 정확한 힘 센서 필요
2. **노이즈 민감성**: 센서 노이즈에 민감
3. **복잡성**: 시스템 설계 복잡
4. **비용**: 힘 센서 비용 부담
5. **안정성**: 불안정성 문제 가능성

## 9. 최신 동향

### 9.1 센서리스 힘 제어
- 전류 기반 힘 추정
- 관찰기 기반 접근법
- 기계학습을 통한 힘 모델링

### 9.2 다중 모달 센서 융합
- 시각-촉각 융합
- 관성-힘 센서 융합
- 청각 센서 활용

### 9.3 AI 기반 힘 제어
- 딥러닝 기반 힘 예측
- 강화학습을 통한 힘 제어 정책 학습
- 적응형 힘 제어 매개변수 튜닝

## 10. 관련 텍스트북 및 참고문헌

### 주요 텍스트북

1. **Siciliano, B., & Villani, L. (1999)**. "Robot Force Control". Kluwer Academic Publishers.
   - 힘 제어의 가장 포괄적인 전문서
   - 이론부터 실제 구현까지 상세 다룸

2. **Craig, J. J. (2005)**. "Introduction to Robotics: Mechanics and Control" (3rd Edition). Pearson.
   - 힘 제어의 기초 개념
   - 하이브리드 제어 소개

3. **De Schutter, J., Bruyninckx, H., Dutré, S., De Geeter, J., Katupitiya, J., Demey, S., & Lefebvre, T. (2007)**. "Force Control: A Bird's Eye View". Springer.
   - 힘 제어의 다양한 접근법 비교
   - 체계적인 분류와 분석

### 중요 논문들

1. **Mason, M. T. (1981)**. "Compliance and Force Control for Computer Controlled Manipulators". IEEE Transactions on Systems, Man, and Cybernetics.
   - 하이브리드 위치/힘 제어의 이론적 기초
   - 접촉 작업의 기하학적 분석

2. **Raibert, M. H., & Craig, J. J. (1981)**. "Hybrid Position/Force Control of Manipulators". ASME Journal of Dynamic Systems, Measurement, and Control.
   - 하이브리드 제어의 실제 구현
   - 안정성 분석

3. **Yoshikawa, T. (1987)**. "Dynamic Hybrid Position/Force Control of Robot Manipulators". IEEE Journal of Robotics and Automation.
   - 동적 하이브리드 제어
   - 관성 효과 고려

4. **Chiaverini, S., Siciliano, B., & Villani, L. (1999)**. "A Survey of Robot Interaction Control Schemes with Experimental Comparison". IEEE/ASME Transactions on Mechatronics.
   - 다양한 상호작용 제어 기법 비교
   - 실험적 검증

### 최신 연구 동향
- **Ajoudani, A., et al. (2018)**. "Progress and Prospects of the Human-Robot Collaboration". Autonomous Robots.
- **Villani, L., & De Schutter, J. (2016)**. "Force Control". Springer Handbook of Robotics.

이 문서는 Siciliano & Villani의 "Robot Force Control"과 Mason의 하이브리드 제어 이론을 주요 참고문헌으로 하여 작성되었습니다.
